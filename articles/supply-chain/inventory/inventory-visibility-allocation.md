---
title: توزيع مخزون Inventory Visibility
description: يشرح هذا المقال كيفية إعداد واستخدام ميزة تخصيص المخزون، والتي تتيح لك تخصيص مخزون مخصص لضمان قدرتك على تلبية أكثر القنوات أو العملاء ربحية.
author: yufeihuang
ms.date: 11/04/2022
ms.topic: article
ms.search.form: ''
audience: Application User
ms.reviewer: kamaybac
ms.search.region: Global
ms.author: yufeihuang
ms.search.validFrom: 2022-05-13
ms.dyn365.ops.version: 10.0.27
ms.openlocfilehash: 449ca0616405ba589b92fba1ef078a4350d1e3b1
ms.sourcegitcommit: 49f8973f0e121eac563876d50bfff00c55344360
ms.translationtype: HT
ms.contentlocale: ar-SA
ms.lasthandoff: 11/14/2022
ms.locfileid: "9762662"
---
# <a name="inventory-visibility-inventory-allocation"></a>توزيع مخزون Inventory Visibility

[!include [banner](../includes/banner.md)]

## <a name="business-background-and-purpose"></a>الخلفية التجارية والغرض منها

غالبًا ما يتعين على المؤسسات تخصيص مخزونها اليدوي مسبقًا لأهم قنوات البيع ومجموعات العملاء والمناطق والأحداث الترويجية لضمان حماية المخزون المخصص مسبقًا من أي استخدام آخر ولا يمكن استهلاكه إلا من خلال معاملات البيع ذات الصلة بالتخصيص. يعتبر تخصيص المخزون في رؤية المخزون أحد مكونات عملية التخطيط التشغيلي للمبيعات، ويتم إجراؤه قبل حدوث أنشطة المبيعات الفعلية وإنشاء أمر مبيعات.

على سبيل المثال، تنتج شركة تدعى Contoso دراجة شهيرة. لسوء الحظ، نظرًا لأن اضطراب سلسلة التوريد الأخير قد أثر على جميع المخزون العابر لتلك الدراجة، فإن Contoso لديها مخزون محدود فقط في متناول اليد ويجب أن تستخدم بشكل أفضل. تقوم شركة Contoso بالمبيعات عبر الإنترنت وفي المتاجر. في كل قناة مبيعات، تمتلك الشركة عددًا قليلاً من الشركاء المؤسسيين المهمين (الأسواق وتجار التجزئة الكبار) الذين يطالبون بتوفير جزء معين من مخزون الدراجة المتاح لهم. لذلك، يجب أن تكون شركة الدراجات قادرة على موازنة توزيع المخزون عبر القنوات وأيضًا إدارة توقعات شركائها من كبار الشخصيات. أفضل طريقة لتحقيق كلا الهدفين هي استخدام تخصيص المخزون، بحيث يمكن لكل قناة وبائع تجزئة تلقي كميات مخصصة محددة يمكن بيعها للمستهلكين لاحقًا.

تخصيص المخزون له غرضان تجاريان أساسيان:

- **حماية المخزون (المبارزة)** – ترغب المؤسسات في تخصيص مخزون محدود أو محدود مسبقًا للقنوات والمناطق والعملاء من كبار الشخصيات والشركات الفرعية ذات الأولوية. تهدف ميزة تخصيص رؤية المخزون إلى حماية المخزون المخصص، بحيث لا تؤثر عمليات التخصيص أو الحجوزات أو طلبات المبيعات الأخرى على المخزون المخصص مسبقًا.
- **التحكم في البيع الزائد** – تهدف ميزة تخصيص رؤية المخزون إلى وضع قيود على الكميات المخصصة مسبقًا، بحيث لا يفرط الطرف المتلقي (على سبيل المثال، قناة أو مجموعة عملاء) في استهلاكها عندما تكون معاملة المبيعات الفعلية التي تستند إلى حجز بسيط تدخل حيز التنفيذ.

## <a name="allocation-definition-in-inventory-visibility-service"></a>تعريف التخصيص في خدمة رؤية المخزون

### <a name="allocation-virtual-pool"></a>تجمع افتراضي للتخصيص

على الرغم من أن ميزة التخصيص في رؤية المخزون لا تضع جانباً كميات المخزون المادية، إلا أنها تشير إلى كمية المخزون المادية المتاحة لتحديد كمية تجمع افتراضي أولي *متاح للتخصيص* خاص بها. يعد تخصيص المخزون في رؤية المخزون تخصيصًا بسيطًا. يتم إجراؤه قبل حدوث معاملات المبيعات الفعلية ولا يعتمد على أوامر المبيعات. على سبيل المثال، يمكنك تخصيص مخزون لأهم قنوات مبيعاتك أو كبار تجار التجزئة في الشركات قبل أن يزور أي عميل نهائي قناة المبيعات أو متجر البيع بالتجزئة لشرائه.

### <a name="difference-between-inventory-allocation-and-soft-reservation"></a>الفرق بين توزيع المخزون والحجز المرن

[عادةً ما يتم ربط عمليات الحجز المرن](inventory-visibility-reservations.md) بحركات المبيعات الفعلية (بنود أوامر التوريد). يمكن استخدام كل من التخصيص والحجز المرن بشكل مستقل، ولكن إذا كنت ترغب في استخدامهما معًا، يجب إجراء الحجز المرن بعد التخصيص. نوصيك بتخصيص المخزون أولاً ثم الحجز المرن مقابل الكميات المخصصة لتحقيق استهلاك قريب من الوقت الحقيقي مقابل التخصيص. لمزيد من المعلومات، راجع [استهلاك كحجز برمجي](#consume-to-soft-reserved).

تتيح ميزة تخصيص المخزون لمخططي المبيعات أو مديري الحسابات الرئيسية إدارة المخزون المهم وتخصيصه مسبقًا عبر مجموعات التخصيص (مثل القنوات والمناطق ومجموعات العملاء). كما أنه يدعم التتبع في الوقت الفعلي، والتعديل، وتحليلات الاستهلاك مقابل الكميات المخصصة، لضمان إعادة التزويد أو إعادة التخصيص في الوقت المحدد. تعد هذه القدرة على الحصول على رؤية في الوقت الفعلي في التخصيص والاستهلاك والتخصيص مهمة بشكل خاص في أحداث البيع السريع أو الترويج.

## <a name="terminology"></a>المصطلحات

المصطلحات والمفاهيم التالية مفيدة في مناقشات تخصيص المخزون:

- **مجموعة التخصيص** – المجموعة التي تمتلك التخصيص، مثل قناة المبيعات أو مجموعة العملاء أو نوع الأمر.
- **قيمة مجموعة التخصيص** – قيمة كل مجموعة تخصيص. على سبيل المثال، قد يكون *الويب* أو *المتجر* قد تكون قيمة مجموعة تخصيص قنوات المبيعات، بينما قد يكون *كبار الشخصيات* أو *عادي* قيمة مجموعة تخصيص العملاء.
- **التدرج الهرمي للتخصيص** – وسيلة لدمج مجموعات التخصيص بطريقة هرمية. على سبيل المثال، يمكنك تحديد *قناة* كمستوى هرمي 1، *والمنطقة* كمستوى 2، *ومجموعة العملاء* كمستوى 3. أثناء تخصيص المخزون، يجب عليك اتباع التسلسل الهرمي للتخصيص عندما تحدد قيمة مجموعة التخصيص. على سبيل المثال، قد تخصص 200 دراجة حمراء لقناة *الويب* ومنطقة *لندن* ومجموعة العملاء من *كبار الشخصيات*.
- **متاح للتخصيص** – *التجمع الشائع الافتراضي* التي تشير إلى الكمية المتوفرة لمزيد من التخصيص. إنه مقياس محسوب يمكنك تحديده بحرية باستخدام الصيغة الخاصة بك. إذا كنت تستخدم أيضًا ميزة الحجز البرمجي، نوصيك باستخدام نفس الصيغة لحساب المتاح للتخصيص والمتاح للحجز.
- **مخصص** – مقياس مادي يوضح الحصة المخصصة التي يمكن لمجموعات التخصيص استهلاكها. يتم الخصم في نفس الوقت الذي يتم فيه إضافة الكمية المستهلكة.
- **تم الاستهلاك** – مقياس مادي يشير إلى الكميات التي تم استهلاكها مقابل الكمية المخصصة الأصلية. عند إضافة الأرقام إلى هذا المقياس المادي، يتم تقليل القياس المادي المخصص تلقائيًا.

يوضح الرسم التوضيحي التالي سير عمل الأعمال لتخصيص المخزون.

![سير عمل أعمال تخصيص رؤية المخزون.](media/inventory-visibility-allocation-flow.png "سير عمل أعمال تخصيص رؤية المخزون.")

يبين التوضيح التالي التسلسل الهرمي للتخصيص ومجموعات التخصيص. *التجمع العام الظاهري* الموضح هنا هو الكمية المتاحة للتخصيص.

[<img src="media/inventory-visibility-allocation-hierarchy.png" alt="Inventory Visibility allocation hierarchy." title="التسلسل الهرمي لتخصيص رؤية المخزون" width="720" />](media/inventory-visibility-allocation-hierarchy.png)

## <a name="set-up-inventory-allocation"></a>إعداد تخصيص المخزون

تتكون ميزة تخصيص المخزون من المكونات التالية:

- مصدر البيانات المحدد مسبقًا والمرتبط بالتخصيص والمقاييس المادية والمقاييس المحسوبة.
- مجموعات تخصيص قابلة للتخصيص لها ثمانية مستويات كحد أقصى.
- مجموعة من واجهات برمجة تطبيقات التخصيص (APIs):

    - تخصيص
    - إعادة تخصيص
    - إلغاء تخصيص
    - استهلاك
    - استعلام

تتكون عملية تكوين ميزة التخصيص من ثلاث خطوات:

- قم بتمكين الميزة في تطبيق رؤية المخزون من خلال الانتقال إلى **التكوين \> إدارة الميزات والإعدادات \> التخصيص**.
- قم بإعداد [مصدر البيانات](inventory-visibility-configuration.md#data-source-configuration) [ومقاييسها](inventory-visibility-configuration.md#data-source-configuration-physical-measures).
- قم بإعداد اسم مجموعة التخصيص والتسلسل الهرمي.

### <a name="predefined-data-source"></a>مصدر بيانات محدد مسبقًا

عندما تقوم بتمكين ميزة التخصيص واستدعاء واجهة برمجة تطبيقات تحديث التكوين، فإن رؤية المخزون تنشئ مصدر بيانات واحدًا محددًا مسبقًا والعديد من الإجراءات الأولية.

تمت تسمية مصدر البيانات باسم `@iv`. يتضمن مجموعة من المقاييس المادية الافتراضية. يمكن عرضها من تطبيق رؤية المخزون عن طريق الانتقال إلى **التكوين \> مصدر البيانات**. يجب ان تشاهد **مصدر البيانات - @IV**. قم بتوسيع مصدر البيانات `@iv` لعرض قائمه بالمقاييس المادية الأولية:

- `@iv`

    - `@allocated`
    - `@cumulative_allocated`
    - `@consumed`
    - `@cumulative_consumed`

حدد علامة التبويب **المقاييس المحسوبة** لعرض القياس المحسوب الأولي، الذي يسمى `@iv.@available_to_allocate`:

- `@iv`

    - `@iv.@available_to_allocate` = `??` – `??` – `@iv.@allocated`

### <a name="add-other-physical-measures-to-the-available-to-allocate-calculated-measure"></a>أضف مقاييس مادية أخرى إلى المقياس المحسوب المتاح للتخصيص

لاستخدام التخصيص، يجب عليك إعداد الصيغة بشكل صحيح من أجل المقياس المحسوب المتاح للتخصيص (`@iv.@available_to_allocate`). على سبيل المثال، لديك مصدر بيانات `fno` ومقياس `onordered` ومصدر بيانات `pos` ومقياس `inbound` وتريد إجراء تخصيص مخزون متاح لمجموع `fno.onordered` و `pos.inbound`. في هذه الحالة، يجب أن يحتوي `@iv.@available_to_allocate` على `pos.inbound` و `fno.onordered` في المعادلة. وفيما يلي مثال على ذلك:

`@iv.@available_to_allocate` = `fno.onordered` + `pos.inbound` – `@iv.@allocated`

> [!NOTE]
> مصدر `@iv` البيانات هو مصدر بيانات معرف مسبقا والمقاييس الفعلية التي تم تعريفها في `@iv` بالبادئة `@` هي بمثابه مقاييس معرفه مسبقا. وتعد هذه المقاييس تكوينا معرفا مسبقا لميزه التخصيص ، لذلك لا تقم بتغييرها أو حذفها ، أو قد تواجه أخطاء غير متوقعه عند استخدام ميزه التوزيع.
>
> يمكنك أضافه مقاييس فعليه جديده إلى المقياس `@iv.@available_to_allocate` المحسوب المعرف مسبقا ، ولكن يجب الا تقوم بتغيير اسمه.

### <a name="manage-allocation-groups"></a>إدارة مجموعات التخصيص

يمكن تعيين ثمانية أسماء مجموعة تخصيص كحد أقصى. المجموعات لها تسلسل هرمي. اتبع هذه الخطوات لعرض مجموعات التخصيص وتحديثها.

1. قم بتسجيل الدخول إلى بيئة Power Apps الخاصة بك، وافتح **رؤية المخزون**.
1. افتح صفحة **التكوين** ثم من علامة تبويب **التخصيص** حدد **تحرير التكوين**. بشكل افتراضي، يوجد تدرج هرمي للتوزيع يحتوي على أربعة طبقات: `Channel` (الطبقة العليا)، `customerGroup` (الطبقة الثانية)،`Region` (الطبقة الثالثة)، `OrderType` (الطبقة الرابعة).
1. يمكنك إزالة مجموعة تخصيص موجودة من خلال تحديد العلامة **X** المجاورة لها. يمكنك أيضًا إضافة مجموعات تخصيص جديدة للتسلسل الهرمي عن طريق إدخال اسم كل مجموعة جديدة مباشرة في الحقل.

    > [!IMPORTANT]
    > كن حذرًا عند حذف أو تغيير تعيين التدرج الهرمي للتخصيص. للحصول على إرشادات، راجع [تلميحات حول استخدام التخصيص](#allocation-tips).

1. عند الانتهاء من تكوين إعدادات مجموعة التخصيص والتدرج الهرمي، قم بحفظ التغييرات التي أجريتها، ثم حدد **تحديث التكوين** في أعلى اليمين. سيتم تحديث قيم مجموعات التخصيص التي تم تكوينها عند إنشاء تخصيص باستخدام واجهة المستخدم أو API POST ‏(/api<wbr>/بيئة<wbr>/\{environmentId‎\}<wbr>/التخصيص<wbr>/إجراء التخصيص). يتم توفير التفاصيل حول كلا الأسلوبين لاحقًا في هذه المقالة.

إذا كنت تستخدم أربعة أسماء مجموعات وقمت بتعيينها إلى \[`channel`، `customerGroup`، `region`، `orderType`\]، ستكون هذه الأسماء صالحة للطلبات المتعلقة بالتخصيص عند استدعاء واجهة برمجة تطبيقات تحديث التكوين.

### <a name="tips-for-using-allocation"></a><a name="allocation-tips"></a>نصائح لاستخدام التخصيص

- لكل منتج، يجب أن تستخدم وظيفة التخصيص في نفس *مستوى الأبعاد* وفقًا للتسلسل الهرمي لفهرس المنتج الذي قمت بتعيينه [في تكوين التدرج الهرمي لفهرس المنتجات.](inventory-visibility-configuration.md#index-configuration). علي سبيل المثال ، لنفترض ان التسلسل الهرمي للفهرس هو \[`Site`و `Location`و `Color`و `Size`\]. إذا قمت بتوزيع بعض الكمية لمنتج واحد في مستوي \[`Site`البعد، `Location`و `Color`\] ، فانه في المرة التالية التي ترغب في تخصيص هذا المنتج فيها ، يجب عليك أيضا التخصيص علي نفس المستوي و \[`Site`و `Location`و `Color`\] إذا كنت تستخدم المستوي \[`Site`أو `Location`و `Color`و `Size`\] أو \[`Site`و `Location`\] ، فان البيانات لن تكون متناسقة.
- **تعديل مجموعات التخصيص والتدرج الهرمي:** إذا كانت بيانات التخصيص موجودة بالفعل في النظام، سيؤدي حذف مجموعات التخصيص الموجودة أو وردية في التدرج الهرمي لمجموعة التخصيص إلى اتلاف التعيين الموجود بين مجموعات التخصيص. لذلك، تأكد من تنظيف كافة البيانات القديمة يدويًا قبل تحديث التكوين الجديد. ومع ذلك، نظرًا لأن إضافة مجموعات التوزيع الجديدة إلى التسلسل الهرمي الأدنى لا يؤثر على التعيينات الموجودة، فلن تحتاج إلى تنظيف البيانات.
- سيتم التخصيص بنجاح فقط إذا كان للمنتج كمية `available_to_allocate` موجبة.
- لتخصيص منتجات من مجموعه مستوي *توزيع عاليه الجودة* إلى مجموعه فرعيه ، استخدم واجهه برمجه التطبيقات `Reallocate` الAPI. علي سبيل المثال، لديك التدرج الهرمي \[`channel`و `customerGroup`و `region`و `orderType`\]و الذي تريد تخصيص بعض المنتجات من مجموعه \[التوزيع عبر الإنترنت ، فب\] مجموعه \[التخصيص الفرعية عبر الإنترنت ، فب ، EU\] ، استخدم `Reallocate` الAPI لنقل الكمية. في حاله استخدام واجهه برمجه التطبيقات `Allocate` (API) ، سيتم تخصيص الكمية من الوعاء العام الظاهري.
- لعرض توفر المنتجات العامة (الوعاء العام)، استخدم [واجهة برمجة التطبيقات الفعلية](inventory-visibility-api.md#query-on-hand) للاستعلام لطلب مبلغ المخزون المتوفر الذي سيتم *تخصيصه*. يمكنك بعد ذلك إجراء قرارات بالتخصيص استنادًا إلى هذه المعلومات.

## <a name="use-the-allocation-api"></a><a name="using-allocation-api"></a>استخدم واجهة برمجة تطبيقات التخصيص

حاليًا، تم فتح خمس واجهات برمجة تطبيقات للتخصيص:

- **نشر /واجهة برمجة التطبيقات<wbr>/البيئة<wbr>/\{environmentId‎\}<wbr>/التخصيص<wbr>/تخصيص** - يتم استخدام واجهة برمجة التطبيقات هذه لإنشاء التخصيص الأولي.
- **نشر /واجهة برمجة التطبيقات<wbr>/البيئة<wbr>/\{environmentId\}<wbr>/التخصيص<wbr>/إلغاء التخصيص** - يتم استخدام واجهة برمجة التطبيقات هذه لتحويل أو إزالة الكميات المخصصة.
- **نشر /واجهة برمجه التطبيقات<wbr>/البيئة<wbr>/\{environmentId\}<wbr>/التخصيص<wbr>/إعادة التخصيص** - تستخدم واجهة برمجة التطبيقات هذه لنقل الكمية المخصصة من توزيع موجود إلى مجموعات توزيع أخرى.
- **نشر /واجهة برمجة التطبيقات<wbr>/البيئة<wbr>/\{environmentId\}<wbr>/التخصيص<wbr>/استهلاك** - يتم استخدام واجهة برمجة التطبيقات هذه لخصم (استخدام) الكميات المخصصة.
- **نشر /واجهة برمجة تطبيقات<wbr>/البيئة<wbr>/\{environmentId\}<wbr>/التخصيص<wbr>/استعلام** - تستخدم واجهة برمجة التطبيقات هذه للتحقق من سجلات التوزيع الموجودة مقابل مجموعات التخصيص والتدرج الهرمي.

### <a name="allocate"></a>توزيع

قم باستدعاء واجهة برمجة تطبيقات `Allocate` لتخصيص منتج له أبعاد معينة. هنا مخطط نص الطلب.

```json
{
    "id": "string",
    "productId": "string",
    "dimensionDataSource": "string",
    "groups": {
        "groupA": "string",
        "groupB": "string",
        "groupC": "string"
    },
    "quantity": 0,
    "organizationId": "string",
    "dimensions": {
        "dimension1": "string",
        "dimension2": "string",
        "dimension3": "string"
    }
}
```

على سبيل المثال، تريد تخصيص كمية 10 لمنتج *الدراجة*، والموقع *1* والمكان *11* واللون *أحمر* *وعلى الإنترنت*، ومجموعة عملاء *كبار الشخصيات*، والمنطقة *الولايات المتحدة*. للقيام بهذا التخصيص، يمكنك إجراء مكالمة تحتوي على محتوى النص التالي.

```json
{
    "id": "test101",
    "productId": "Bike",
    "groups": {
        "channel": "Web",
        "customerGroup": "VIP",
        "region": "US"
    },
    "quantity": 10,
    "organizationId": "usmf",
    "dimensions": {
        "siteId": "1",
        "locationId": "11",
        "colorId": "red"
    }
}
```

يجب أن تكون الكمية دائمًا أكبر من 0 (صفر).

### <a name="unallocate"></a>إلغاء تخصيص

استخدم واجهة برمجة تطبيقات `Unallocate` لإلغاء عملية `Allocate`. غير مسموح بالكمية السالبة في عملية `Allocate`. نص `Unallocate` مطابق لنص `Allocate`.

### <a name="reallocate"></a>إعادة تخصيص

استخدم واجهة برمجة تطبيقات `Reallocate` لنقل بعض الكمية المخصصة إلى تركيبة مجموعات أخرى. هنا مخطط نص الطلب.

```json
{
    "id": "string",
    "productId": "string",
    "dimensionDataSource": "string",
    "sourceGroups": {
        "groupA": "string",
        "groupB": "string",
        "groupC": "string"
    },
    "groups": {
        "groupD": "string",
        "groupE": "string",
        "groupF": "string"
    },
    "quantity": 0,
    "organizationId": "string",
    "dimensions": {
        "dimension1": "string",
        "dimension2": "string",
        "dimension3": "string"
    }
}
```

على سبيل المثال، يمكنك نقل دراجتين لهما الأبعاد \[الموقع=1، المكان=11, اللون=أحمر\] من مجموعة التخصيص \[على الإنترنت، كبار الشخصيات، الولايات المتحدة\] إلى مجموعة التخصيص \[على الإنترنت، كبار الشخصيات، الاتحاد الأوروبي\] عن طريق استدعاء واجهة برمجة تطبيقات `Reallocate` وتوفير النص الأساسي التالي.

```json
{
    "id": "test102",
    "productId": "Bike",
    "sourceGroups": {
        "channel": "Web",
        "customerGroup": "VIP",
        "region": "US"
    },
    "groups": {
        "channel": "Web",
        "customerGroup": "VIP",
        "region": "EU"
    },
    "quantity": 2,
    "organizationId": "usmf",
    "dimensions": {
        "siteId": "1",
        "locationId": "11",
        "colorId": "red"
    }
}
```

### <a name="consume"></a>الاستهلاك

استخدم واجهة برمجة تطبيقات `Consume` لترحيل كمية الاستهلاك مقابل التخصيص. على سبيل المثال، يمكنك استخدام واجهة برمجة التطبيقات هذه لنقل الكمية المخصصة إلى بعض المقاييس الحقيقية. هنا مخطط نص الطلب.

```json
{
    "id": "string",
    "productId": "string",
    "dimensionDataSource": "string",
    "groups": {
        "groupA": "string",
        "groupB": "string",
        "groupC": "string"
    },
    "quantity": 0,
    "organizationId": "string",
    "dimensions": {
        "dimension1": "string",
        "dimension2": "string",
        "dimension3": "string"
    },
    "physicalMeasures": {
        "datasource1": {
            "measure": "string" // Addition or Subtraction
        }
    }
}
```

على سبيل المثال، هناك ثماني دراجات مخصصة لها أبعاد \[الموقع=1, المكان=11، اللون=أحمر\] لمجموعة التخصيص \[على الإنترنت، كبار الشخصيات، الولايات المتحدة\]. يتم استخدام الصيغة التالية المتاحة للتخصيص:

`@iv.@available_to_allocate` = `fno.onordered` + `pos.inbound` – `@iv.@allocated`

يتم تخصيص الدراجات الثماني من مقياس `pos.inbound`.

الآن، تم بيع ثلاث دراجات، وتم أخذها من مجموعة التخصيص. لتسجيل هذه الخطوة، يمكنك إجراء مكالمة تحتوي على نص الطلب التالي.

```json
{
    "id": "test103",
    "organizationId": "usmf",
    "productId": "Bike",
    "dimensions": {
        "siteId": "1",
        "locationId": "11",
        "colorId": "red"
    },
    "groups": {
        "channel": "Web",
        "customerGroup": "VIP",
        "region": "US"
    },
    "quantity": 3,
    "physicalMeasures": {
        "pos": {
            "inbound": "Subtraction"
        }
    }
}
```

بعد هذا الاستدعاء، سيتم تقليل الكمية المخصصة للمنتج بمقدار 3. بالإضافة إلى ذلك، ستنشئ رؤية المخزون حدث تغيير متاح حيث `pos.inbound` = *-3*. بدلاً من ذلك، يمكنك الاحتفاظ بقيمة `pos.inbound` كما هي واستهلاك الكمية المخصصة فقط. ومع ذلك، في هذه الحالة، يجب عليك إما إنشاء مقياس مادي آخر للاحتفاظ بالكميات المستهلكة أو استخدام المقياس المحدد مسبقًا `@iv.@consumed`.

في هذا الطلب، لاحظ أن المقياس المادي الذي تستخدمه في نص طلب الاستهلاك يجب أن يستخدم نوع المعدل المعاكس (الجمع أو الطرح)، مقارنة بنوع المعدل المستخدم في القياس المحسوب. لذلك في نص الاستهلاك هذا، يحتوي `iv.inbound` على قيمة `Subtraction`، وليس على `Addition`.

لا يمكن استخدام مصدر بيانات `fno` في نص الاستهلاك كما زعمنا دائمًا أن رؤية المخزون لا يمكنها تغيير أي بيانات لمصدر بيانات `fno`. يكون تدفق البيانات باتجاه واحد، مما يعني أنه يجب الحصول على كافة تغييرات الكمية لمصدر البيانات `fno` من بيئة Supply Chain Management.

### <a name="consume-as-a-soft-reservation"></a><a name="consume-to-soft-reserved"></a>الاستهلاك كحجز برمجي

يمكن لواجهة برمجة تطبيقات `Consume` أيضًا أن تستهلك الكمية المخصصة كحجز برمجي. في هذه الحالة، ستعمل عملية `Consume` على تقليل الكمية المخصصة ثم إجراء حجز برمجي لتلك الكمية. لاستخدام هذا الأسلوب، يجب أن تستخدم أيضًا ميزة [الحجز البرمجي](inventory-visibility-reservations.md) لرؤية المخزون.

على سبيل المثال، لقد قمت بتعيين مقياس مادي لحجز مرن كـ `iv.softreserved`. تُستخدم الصيغة التالية للمقياس المحسوب المتاح للاحتياطي:

`iv.available_to_reserve` = `fno.onordered` + `pos.inbound` – `iv.softreserved`

لاستخدام هذا الإعداد مع ميزة التخصيص، أضف `@iv.@allocated` إلى `iv.available_to_reserve` لإنتاج الصيغة التالية:

`iv.available_to_reserve` = `fno.onordered` + `pos.inbound` – `iv.softreserved` – `@iv.@allocated`

وبعد ذلك، قم بتحديث `@iv.@available_to_allocate` إلى القيمة نفسها.

عندما تريد استهلاك كمية 3 والاحتفاظ بهذه الكمية مباشرة، يمكنك إجراء مكالمة تحتوي على نص الطلب التالي.

```json
{
    "id": "???",
    "organizationId": "usmf",
    "productId": "Bike",
    "dimensions": {
        "siteId": "1",
        "locationId": "11",
        "colorId": "red"
    },
    "groups": {
        "channel": "Web",
        "customerGroup": "VIP",
        "region": "US"
    },
    "quantity": 3,
    "physicalMeasures": {
        "iv": {
            "softreserved": "Addition"
        }
    }
}
```

في هذا الطلب، لاحظ أن `iv.softreserved` يحتوي على القيمة `Addition`، وليس `Subtraction`.

### <a name="query"></a>استعلام

استخدم واجهة برمجة تطبيقات `Query` لاسترداد المعلومات المتعلقة بالتخصيص لبعض المنتجات. يمكنك استخدام عوامل تصفية الأبعاد وعوامل تصفية مجموعة التخصيص لتضييق نطاق النتائج. يجب أن تتطابق الأبعاد تمامًا مع الأبعاد التي تريد استردادها، على سبيل المثال، سيحتوي \[الموقع=1, المكان=11\] على النتائج غير ذات الصلة مقارنةً بـ \[الموقع=1، المكان=11, اللون=أحمر\].

```json
{
    "productId": "string",
    "organizationId": "string",
    "dimensions": {
        "dimension1": "string",
        "dimension2": "string",
        "dimension3": "string"
    },
    "groups": {
        "additionalProp1": "string",
        "additionalProp2": "string",
        "additionalProp3": "string"
    },
}
```

على سبيل المثال، استخدم \[الموقع=1، المكان=11، اللون=أحمر\] ومجموعات فارغة للحصول على جميع سجلات التخصيص:

```json
{
    "organizationId": "usmf",
    "productId": "Bike",
    "dimensions": {
        "siteId": "1",
        "locationId": "11",
        "colorId": "red"
    },
    "groups": {
        "channel": "Web",
        "customerGroup": "VIP",
        "region": "US"
    },
}
```

استخدم \[الموقع=1، المكان=11, اللون=أحمر\] والمجموعات \[القناة=على الإنترنت, مجموعة العملاء=كبار الشخصيات، المنطقة=الولايات المتحدة\] للحصول على سجلات التخصيص لهذه المجموعة:

```json
{
    "organizationId": "usmf",
    "productId": "Bike",
    "dimensions": {
        "siteId": "1",
        "locationId": "11",
        "colorId": "red"
    },
    "groups": {
        "channel": "Web",
        "customerGroup": "VIP",
        "region": "US"
    },
}
```

## <a name="use-the-allocation-user-interface"></a>استخدام واجهة مستخدم التوزيع

يمكنك إدارة التخصيصات يدويًا من خلال واجهة المستخدم بفتح تطبيق رؤية المخزون والانتقال إلى تخصيص **الرؤية التشغيلية \> تخصيص**. ومن هناك، يمكنك تنفيذ أي من الإجراءات الموضحة في الأقسام الفرعية التالية.

### <a name="create-an-allocation"></a>إنشاء تخصيص

اتبع الخطوات التالية لإنشاء تخصيص من **صفحة التخصيص** الخاصة بتطبيق رؤية المخزون.

1. حدد **تخصيص**.
1. قم بتعيين قيم مجموعات الحقول الأساسية والأبعاد ومجموعات تخصيص الأهداف. (عند تحديد مصدر بيانات التجميع في **مقطع الأبعاد** استخدم القائمة المنسدلة أولاً لتحديد الأبعاد (على سبيل المثال، `siteId`). ثم أدخل قيم الأبعاد في الحقول التي تظهر.)
1. حدد **إرسال**.

### <a name="consume-an-allocation"></a>استهلاك توزيع

حدد **الاستهلاك** لاستهلاك التوزيع. لضمان الاستهلاك داخل مجموعة التخصيص الصحيحة والتدرج الهرمي، أدخل نفس مجموعات المؤسسة وتفاصيل البعد التي قمت بإدخالها عند إنشاء التخصيص.

### <a name="reallocate-an-allocation"></a>إعادة إنشاء تخصيص

حدد **إعادة التخصيص** لنقل الكمية المخصصة الموجودة من مجموعة من مجموعات التخصيص إلى مجموعة أخرى.

### <a name="query-existing-allocations"></a>الاستعلام عن التوزيعات الموجودة

حدد **استعلام**، ثم ادخل قيم مجموعات المنتجات والمؤسسات والأبعاد والتخصيص للحصول على نتائج الاستعلام لعمليات التخصيص الموجودة.
