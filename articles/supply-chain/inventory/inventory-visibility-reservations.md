---
title: حجوزات Inventory Visibility
description: يصف هذا المقال كيفية إعداد ميزة الحجز لإنشاء عمليات حجز، واستهلاك الحجوزات، و/أو كميات المخزون المحددة غير المفرج عنها باستخدام "رؤية المخزون".
author: yufeihuang
ms.date: 11/04/2022
ms.topic: article
ms.search.form: ''
audience: Application User
ms.reviewer: kamaybac
ms.search.region: Global
ms.author: yufeihuang
ms.search.validFrom: 2021-08-02
ms.dyn365.ops.version: 10.0.21
ms.openlocfilehash: 0ae0589f8bac7ebf9b43cf0f3bc02680d324b29b
ms.sourcegitcommit: 49f8973f0e121eac563876d50bfff00c55344360
ms.translationtype: HT
ms.contentlocale: ar-SA
ms.lasthandoff: 11/14/2022
ms.locfileid: "9762712"
---
# <a name="inventory-visibility-reservations"></a>حجوزات Inventory Visibility

[!include [banner](../includes/banner.md)]

توضح هذه المقالة حالة استخدام نموذجية الحجوزات المرنة وتوضح كيفية إعدادها في رؤية المخزون. يتضمن معلومات حول كيفية إنشاء حجوزات المرنة، وتعويضها عند الاستهلاك الفعلي، وضبط كميات المخزون المحددة أو عدم الاحتفاظ بها.

## <a name="sample-use-case-for-soft-reservation"></a>عينة حالة الاستخدام للحجز المرن

تساعد الحجوزات المرنة المؤسسات في الحصول علي مصدر فردي من الحقيقة للمخزون المتوفر، وخاصة أثناء عملية تنفيذ الأمر. تُعد هذه الوظيفة مفيدة للمؤسسات التي توجد فيها الشروط التالية:

- لدي المؤسسة نظامين مختلفين علي الأقل يستقبلان بشكل مباشر الأوامر الصادرة.
- المؤسسة صارمة جدًا وترغب في منع الحجز المزدوج لمخزون المنتجات، والذي يمكن أن يحدث إذا تمكنت أنظمة متعددة من حجز آخر قطعة من المخزون. يتم منع هذا الموقف عندما يمكن لكافة أنظمة الأمر إجراء اتصالات API للحجز المرن لرؤية المخزون، والذي يوفر مصدرًا واحدًا للحقيقة لتوافر المخزون.

[<img src="media/inventory-visibility-soft-reservation.png" alt="Inventory Visibility soft reservation." title="حجوزات مرنة لرؤية المخزون" width="720" />](media/inventory-visibility-soft-reservation.png)

يوضح الرسم التوضيحي السابق كيفية عمل الحجز المرن وتمييز العمليات التالية:

- تتم مزامنة مستوي المخزون الأولي الخاص بك مع رؤية المخزون من Microsoft Dynamics 365 Supply Chain Management.
- يتم ترحيل الحجوزات المرنة من كل من قنوات الأمر أو الأنظمة إلى رؤية المخزون. تتحقق عملية رؤية المخزون من صحة توفر المخزون وتحاول إقامة حجوزات مرنة. في حالة نجاح الحجز المرن، تضيف إمكانية رؤية المخزون الكمية التي تم حجزها وتخصم من اكمية المتاحة للحجز (AFR)، والاستجابة باستخدام رقم حجز مرن.
- في هذا الوقت، تظل كمية المخزون الفعلية كما هي.
- وبعد ذلك يمكنك مزامنة أوامر الحجز بالنظام الفردي أو المجمع (سطور الأمر) في Supply Chain Management لإجراء حجوزات ثابتة وإصدارها للمستودع أو تحديث كمية المخزون النهائية.
- يمكنك تعيين النظام لـ [إزاحة حجوزات مرنة](#offset-scm) عند تحديث المخزون الفعلي في Supply Chain Management.

يتم إنشاء الحجوزات المرنة واستهلاكها وإلغاءها باستخدام اتصالات API لخدمة رؤية المخزون.

> [!NOTE]
> يمكنك اختياريًا إعداد Supply Chain Management (وأنظمة أخرى تابعة لجهة خارجية) لتعويض الكمية المحجوزة تلقائيًا باستخدام رؤية المخزون. يتم حذف كمية الإزاحة من سجلات الحجز في "رؤية المخزون".
>
> افتراضيًا، يتم تشغيل وظيفة مقاصة تلقائيًا عند تمكين ميزة الحجز المرن.

## <a name="turn-on-and-set-up-the-reservation-feature"></a><a name="turn-on"></a>تشغيل وإعداد ميزة الحجز

لتشغيل ميزة الحجز، اتبع الخطوات التالية.

1. قم بالتسجيل في Power Apps وافتح **رؤية المخزون**.
1. افتح صفحة **التكوين**.
1. في علامة التبويب **إدارة الميزات**، قم بتشغيل ميزة *OnHandReservation*.
1. سجل دخولك إلى بيئة Supply Chain Management.
1. انتقل إلى مساحة عمل **[إدارة الميزات](../../fin-ops-core/fin-ops/get-started/feature-management/feature-management-overview.md)** وقم بتمكين ميزة *تكامل رؤية المخزون مع إزاحة الحجز* (تتطلب الإصدار 10.0.22 أو إصدار لاحق).
1. انتقل إلى **إدارة المخزون \> الإعداد \> معلمات تكامل رؤية المخزون**، افتح علامة تبويب **إزاحة الحجز** ثم قم بالإعدادات التالية:

    - **تمكين إزاحة الحجز** - قم بتعيينها إلى *نعم* لتمكين هذه الوظيفة.
    - **معدل إزاحة الحجز** – حدد حالة حركة المخزون التي ستقوم بازاحة الحجوزات التي تم إجراؤها في رؤية المخزون. يحدد هذا الإعداد مرحلة معالجة الأمر التي تشغل الإزاحات. يتم تتبع المرحلة حسب حالة حركة المخزون الخاصة بالأمر. حدد إحدى القيم التالية:

        - *عند الطلب* – الأوامر التي لها حالة *عند الطلب*، سيقوم أمر بإرسال طلب إزاحة عند إنشائه. ستكون كمية الإزاحة هي الكمية الخاصة بالأمر الذي تم إنشاؤه (بند).
        - *الحجز* - أوامر الشراء التي لها حالة *حجز*، سيقوم بإرسال طلب مقابل عندما تكون محجوزة للطلب أو تم حجزها فعليًا. عند الإزاحة إلى حالة *الحجز*، سيقوم الأمر بإرسال طلب مقابل في أي حالة مخزون جديدة أقرب إلى منتقي محجوز (علي سبيل المثال، انتقاء أو ترحيل كشف التعبئة أو فوترته). يحدث هذا السلوك حتى في حالة تخطي الحجز في Supply Chain Management والاستمرار في حالة مخزون أخرى (علي سبيل المثال، إذا قمت بالتخطي من الإصدار إلى المستودع إلى الانتقاء والتعبئة). سيتم تشغيل الطلب مرة واحدة فقط. إذا تم تشغيلها عند الانتقاء، فلن تقوم بنسخ الإزاحة عند ترحيل كشف التعبئة. ستكون كمية الإزاحة هي الكمية نفسها التي فيها حالة حركة المخزون عند تشغيل الإزاحة (بمعنى آخر، من *تحت الطلب*/*محجوز فعليًا*، أو لاحقًا الحالة، في بند الأمر المقابل).

1. قم بتسجيل الدخول مرة أخرى إلى تطبيق رؤية المخزون، ثم انتقل إلى صفحة **التكوين**، ثم في علامة تبويب **حجز مرن**، راجع التسلسل الهرمي الافتراضي الخاص بالحجز المرن. قم بإضافة أبعاد جديدة إلى التدرج الهرمي حسب الحاجة.
1. في المقطع **إعداد تعيين الحجز المرن**، قم بعرض الإعدادات الافتراضية. بشكل افتراضي، سيتم تسجيل كميات المخزون المحجوزة بالنظام مقابل القياس الفعلي `softreservephysical` لمصدر البيانات `iv`. تم تعيين المقياس المحسوب *متوفر للقياس* إلى `availabletoreserve`. إذا كنت ترغب في تحديث القياس المحسوب `availabletoreserve`، انتقل إلى صفحة **التكوين**، ثم من علامة تبويب **القياس المحسوب**، قم بتوسيع المقياس المحسوب وتعديله.

لمزيد من المعلومات، راجع [تكوين رؤية المخزون](inventory-visibility-configuration.md).

> [!NOTE]
> يصف التسلسل الهرمي للحجز تسلسل الأبعاد التي يجب تحديدها عند إجراء الحجوزات. يعمل بنفس الطريقة التي يعمل بها التدرج الهرمي للفهرس للاستعلامات الفعلية، لكنه يستخدم بشكل مستقل ليتمكن من تحديد تفاصيل البعد لإجراء عمليات حجز أكثر دقه.
>
> يجب أن يحتوي التدرج الهرمي للحجز المرن على `SiteId` و`LocationId` كمكونات، لأنه يقوم بإنشاء تكوين التقسيم لرؤية المخزون.

للحصول على مزيد من المعلومات حول كيفية تكوين الحجوزات، راجع [تكوين الحجز](inventory-visibility-configuration.md#reservation-configuration).

## <a name="use-the-reservation-feature-in-inventory-visibility"></a>استخدام ميزة الحجز في رؤية المخزون

عند استدعاء API الحجز، النظام علامات حجز السلع والكميات المحددة.

فيما يلي مثال علي سيناريو وعينة نص استعلام API أساسي. تبيع شركة Contoso المنتج D0002 (Cabinet) من موقع التجارة الإلكترونية الخاص بها. يقوم العميل بوضع أمر التوريد لخزانة حمراء صغيرة عبر موقع الويب. تقرر Contoso تحقيق هذا الطلب باستخدام الابعاد التالية:

- معرف المؤسسة = usmf
- الموقع = 1
- المستودع = 11
- اسم المنتج = D0002
- اللون = أحمر
- الحجم = صغير

تقوم Contoso بالفعل باعداد اتصال بواجهة برمجة التطبيقات لرؤية المخزون من نظام التجارة الإلكترونية الخاصة به. عند استلام الأمر، يقوم النظام بشكل فوري بتشغيل اتصال API لإجراء حجز مرن لـ cabinet في رؤية المخزون.

### <a name="create-soft-reservations-using-the-reservation-api"></a>إنشاء حجوزات مرنة باستخدام API للحجز

يتم إجراء الحجوزات في خدمة رؤية المخزون عن طريق إرسال طلب POST إلى عنوان URL الخاص بالخدمة، مثل `/api/environment/{environmentId}/onhand/reserve`.

بالنسبة للحجز، يجب أن يحتوي نص الطلب على معرف المؤسسة، معرف المنتج، الكميات المحجوزة والأبعاد.

عند استدعاء API للحجز، يمكنك التحكم في التحقق من صحة الحجز عن طريق تحديد المعلمة المنطقية `ifCheckAvailForReserv` في النص الأساسي للطلب. تعني القيمة `True` أن التحقق من الصحة مطلوب، بينما تعني القيمة `False` أن التحقق من الصحة غير مطلوب. القيمة الافتراضية هي `True`.

إذا كنت ترغب في إلغاء حجز أو إبطال حجز كميات مخزون محددة، فقم بتعيين الكمية على قيمة سالبة، وقم بتعيين معلمة `ifCheckAvailForReserv` إلى `False` لتخطي عملية التحقق من الصحة.

فيما يلي مثال علي نص الطلب الذي يشير إلى ترتيب المبيعات في السياق السابق.

```json
# Url

#Replace {endpoint} with your system endpoint.
    {endpoint}/api/environment/{environmentId}/onhand/reserve

# Method
Post

# Header
# replace {access_token} with the one get from security service
Api-version: "1.0"
Content-Type: "application/json"
Authorization: "Bearer {access_token}"

# Body
{
    "id": "Testrequest-0005",
    "organizationId": "usmf",
    "productId": "D0002",
    "dimensions": {
        "SiteId": "1",
        "LocationId": "11",
        "ColorId": "red",
        "SizeId": "small"
    },
    "quantityDataSource": "iv",
    "modifier": "softreservphysical",
    "quantity": 1,
    "ifCheckAvailForReserv": true
}
```

يقوم طلب الحجز المرن الناجح بإرجاع *معرف حجز مرن* لكل سجل حجز. لا يعد معرف الحجز المرن معرفًا فريدًا لسجل حجز منتج فردي، لكنه بمنزلة مجموعة من قيم الأبعاد ومعرف المنتج المرتبطة بطلب الحجز المرن. يمكنك تسجيل معرف الحجز المرن علي سطر الأمر عند قيامك بمزامنة الأوامر المحجوزة بنجاح لـ Supply Chain Management أو نظام ERP آخر للازاحه.

### <a name="offset-soft-reservations-in-supply-chain-management"></a><a name="offset-scm"></a>إزاحة الحجوزات المرنة في Supply Chain Management

يمكنك أزاحة كمية بحجز مرن بعد طرح الكمية الموجودة في أمر ما بالفعل في Supply Chain Management أو من نظام ERP آخر. توفر رؤية المخزون تكامل مقابل الحجز الخافت الذي يكون جاهزًا مع Supply Chain Management.

اتبع هذه الخطوات لتعويض الحجز المرن.

1. سجل دخولك إلى Supply Chain Management.
1. انتقل إلى **المبيعات والتسويق \> أوامر المبيعات \> كافة أوامر المبيعات‬**.
1. في جزء الإجراء، حدد **جديد**.
1. قم بإعاده إنشاء أمر التوريد الخارجي، وقم بإضافة بند المبيعات الذي يستخدم نفس معرف المنتج والمؤسسة والموقع والمستودع وقيم الأبعاد بالضبط.
1. في علامة FastTab **بنود أمر المبيعات** ، حدد بند المبيعات الذي أدخلته للتو، ثم على شريط الأدوات، حدد **المخزون \> معرف الحجز**.
1. اتبع إحدى الخطوات التالية:

    - قم بنسخ معرف الحجز المرن في استجابه طلب الحجز المرن، ثم قم بلصقه في حقل **معرف الحجز**.
    - اترك حقل **معرف الحجز** فارغًا، لكن حدد خانة اختيار **الإزاحة التلقائية لخدمة المخزون**. سيقوم النظام تلقائيًا بتحديد أي من أبعاد المنتج والمنتج المطلوب إزاحتها وفق معرف الصنف وقيم الأبعاد التي يتم إدخالها في البند المحدد.

1. حدد **موافق**.
1. بينما لا يزال سطر المبيعات نفسه محددًا، احتفظ فعليًا بالكمية المطلوبة عن طريق تحديد **المخزون \> حجز** على شريط أدوات علامة التبويب السريعة FastTab **سطور أوامر المبيعات**.
1. إذا قمت مسبقًا بتعيين حقل **المعدل المقابل للحجز** إلى *محجوز* ، سيتم تشغيل الإزاحة عندما تكون حالة *الحجز الفعلية* أو *الطلب الاحتياطي* لسطر الأمر. تعمل وظيفة المجموعة مرة واحدة لمزامنة الطلبات المقابلة من Supply Chain Management لرؤية المخزون.

> [!NOTE]
> بالنسبة إلى حالات الحركة التي تتضمن معدل إزاحة حجز محدد، سيقوم تحديث الحركة بمعادلة سجل الحجز المقابل عند استيفاء كافة الشروط التالية:
>
> - يتطابق معرف الحجز في حركة المخزون مع معرف الحجز لسجل الحجز في رؤية المخزون.
> - تتطابق أبعاد حركة المخزون مع أبعاد سجل الحجز في رؤية المخزون.
> - تؤدي التغييرات في حالة حركة المخزون إلى عمليات إزاحة للحجوزات عندما تعكس حالة حركة المخزون حقيقة أن عملية الأمر قد اكتملت أو تم تخطيها.

تتبع كمية الإزاحة كمية المخزون المحددة في حركات المخزون ذات الصلة. ستصبح الإزاحة سارية المفعول فقط إذا بقيت الكمية المحجوزة في رؤية المخزون.

### <a name="cancel-or-revert-a-soft-reservation"></a>إلغاء الحجز المرن أو الرجوع عنه

في حاله إلغاء بند أمر أصلي أو حذفه، يجب عليك إعاده الحجز المرن المقابل، قم بترحيل الكمية السالبة التي لها نفس المعلومات في نص استعلام API الخاص بك.
