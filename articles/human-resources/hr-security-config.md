---
title: مفاهيم تكوين الأمان لعمليات التكامل المستندة إلى الجدول الظاهر
description: يوضح هذا المقال بنية لإنشاء تكامل بين Microsoft Dynamics 365 Human Resources وأنظمة أخرى.
author: twheeloc
ms.date: 11/19/2022
ms.topic: article
ms.prod: ''
ms.technology: ''
ms.search.form: CDSIntegrationAdministration
audience: Application User
ms.custom: 7521
ms.assetid: ''
ms.search.region: Global
ms.author: twheeloc
ms.search.validFrom: 2020-10-05
ms.dyn365.ops.version: Human Resources
ms.openlocfilehash: 219ceb0adae0cee5f74a39140ab74af9fdac1eb6
ms.sourcegitcommit: ea79bf014bbf495ac8e28db29502c8bd85a75f32
ms.translationtype: HT
ms.contentlocale: ar-SA
ms.lasthandoff: 11/11/2022
ms.locfileid: "9759645"
---
# <a name="security-configuration-concepts-for-virtual-table-based-integrations"></a>مفاهيم تكوين الأمان لعمليات التكامل المستندة إلى الجدول الظاهر

[!include [Applies to Human Resources](../includes/applies-to-hr.md)]

يوضح هذا المقال البنية التحتية الخاصة باستخدام [Microsoft Dataverse الجداول الافتراضية (الكيانات)](/dev-itpro/power-platform/virtual-entities-overview) ونظام الأجهزة الخارجية Dynamics 365 Human Resources ونظام الأجهزة الخارجية. يركز المقال علي تكوين الأمان، وعلي أوجه المصادقة والتخويل المطلوبة بين حدود النظام لبناء نظام وظيفي وأمن.

## <a name="prerequisite-reference-articles"></a>مقالات مرجعية للمتطلبات الأساسية

توفر المقالات التالية مزيد من المعلومات عن المفاهيم في هذا المقال:

- [نظرة عامة على الكيانات الظاهرية](/dev-itpro/power-platform/virtual-entities-overview)
- [الشروع في العمل على الجداول الظاهرية (الكيانات)](/developer/data-platform/virtual-entities/get-started-ve)
- [استخدام مصادقة خادم إلى خادم متعددة المستأجرين (Microsoft Dataverse)](/developer/data-platform/use-multi-tenant-server-server-authentication)
- [استخدام مصادقة OAuth مع Microsoft Dataverse (Dataverse)](/developer/data-platform/authenticate-oauth)
- [تتدفق بيانات اعتماد عميل OAuth 2.0 على النظام الأساسي لهوية Microsoft](/azure/active-directory/develop/v2-oauth2-client-creds-grant-flow)
- [المصادقة والتخويل](/dev-itpro/power-platform/authentication-and-authorization)

## <a name="architecture"></a>الهندسة 

يوضح الرسم التخطيطي المعماري التالي المفاهيم الرئيسية المتضمنة في التكامل الذي يستخدم جداول ظاهرية (كيانات).

![التكامل القائم على الجدول الظاهري.](./media/Hosts.jpg)

فيما يلي شرح لبعض العناصر الموجودة في المخطط السابق:

- **Microsoft** – ستستضيف Microsoft منتجات Dynamics 365 المختلفة وتديرها بالنيابة عن العملاء.

    - **Azure Active Directory (Azure AD) المستأجر C** – Azure AD مستأجر يمتلكه Microsoft. وهو المستأجر الذي تم تسجيل تطبيقات Dynamics 365 فيه.

- **شريك التكامل**

    - **نظام التكامل** – النظام الذي يتم تكامله مع Dynamics 365. قد يكون نظام رواتب أو أي نظام يعتمد علي البيانات المخزنة في Dynamics 365.
    - **المحول** – البرنامج أو الخدمة المسؤولة عن التفاعل مع كل من Dynamics 365 ونظام تكامل.

        > [!NOTE]
        > إذا كان المحول معد للاستخدام بواسطة عملاء Dynamics 365 المتعددين، فإن المتوقع أنه سيتم تسجيله كتطبيق متعددة العناصر في Azure AD.

    - **Azure AD المستأجر A** – Azure AD مستأجر يمتلكه شريك التكامل. وهو المستأجر الذي تم تسجيل محول معرف التطبيق فيه.

- **عميل مشترك** – عميل يقوم بتنفيذ Dynamics 365 Human Resources الحل الخاص بالشريك وتكامله.

    - **Dynamics 365 Finance أو الموارد البشرية** – المثيل الخاص بالعميل للغة Dynamics 365 Finance أو الموارد البشرية التي تحتوي علي بيانات العميل التي يتطلبها نظام تكامل.
    - **Dataverse**– البيئة الخاصة Dataverse بالعميل والتي يتم ربطها اما بالمالية أو بالموارد البشرية. Dataverse توفر API للويب للتفاعل مع بيانات Dynamics 365.
    - **Azure AD المستأجر B** – مستاأجر العميل Azure AD. يعمل كموفر الهوية (خادم التخويل) والرموز المميزة التي تقوم بتخويل مجري الاتصال للاتصال بمثيل العميل Dataverse.

## <a name="basic-request-flow"></a>تدفق الطلب الأساسي

يصف هذا المقطع التدفق الأساسي لطلب نموذجي متضمن في التكامل. يشير إلى الرسم التخطيطي المعماري المذكور سابقًا في هذه المقالة.

يتطلب الطلب النموذجي أن يقوم المحول بالاستعلام عن Dynamics 365 للبيانات، ثم حفظ تلك البيانات ومزامنتها مع النظام المتكامل.

1. يقوم المحول باستدعاء واجهة ويب Dataverse للاستعلام عن البيانات ذات الصلة.

    > [!NOTE]
    > المصادقة هي متطلب أساسي، والحصول علي الرمز المميز هو جزء رئيسي من العملية. سيتم وصف المصادقة في مقطع [المصادقة والتخويل في حدود النظام](#authentication-and-authorization-at-system-boundaries).

    يتم اجراء الاتصال على واجهة ويب Dataverse للاستعلام عن بيانات التطبيقات التي يتم عرضها من خلال جدول ظاهري. راجع "2. ‏‫المزامنة الأولية‬" و"3. مزامنة Delta" في الرسم التخطيطي.)

2. Dataverse يتيح معالجة الطلب عن طريق الاستعلام عن الجدول الظاهري من خلال أداة توصيل الوحدة الظاهرية ("وكيل الجدول الظاهري" في الرسم التخطيطي). تتم إعاده توجيه الطلب Dataverse إلى الخدمة المالية أو خدمة الكيانات الظاهرية للموارد البشرية للاستعلام عن البيانات التي تم تخزينها فعليًا في قاعدة بيانات التمويل أو الموارد البشرية.
3. تقوم خدمة الكيان الفعلي للموارد المالية أو الموارد البشرية بترجمة الطلب مقابل الكيان الظاهري إلى استعلام مقابل الوحدة المالية أو كيان الموارد البشرية الذي يقوم بنسخ الكيان الظاهري Dataverse. يتم استرداد البيانات من قاعده البيانات، وتحويلها مرة أخرى إلى تمثيل الوحدة Dataverse وإرجاعها إلى مجري الاتصال.
4. يقوم المحول بإكمال أي تعيين وترجمة بيانات مطلوبة، كما يقوم بالاتصال بنظام تكامل لاستمرار البيانات في تكامل قاعدة بيانات النظام. راجع "4. حفظ البيانات" في الرسم التخطيطي.)

## <a name="authentication-and-authorization-at-system-boundaries"></a>المصادقة والتخويل في حدود النظام

تتحقق *المصادقة* من صحة أن هوية المستخدم أو التطبيق قد تمت مصادقتها، وتؤكد أن المستخدم أو التطبيق كما يقولون. يمنع *التخويل* المستخدم أو التطبيق حق الوصول إلى أذونات محددة علي مستوي التطبيق. لمزيد من المعلومات، راجع [المصادقة مقابل التخويل](/azure/active-directory/develop/authentication-vs-authorization).

معظم الاتصالات عبر النظام في الرسم التخطيطي المعماري السابق في هذه المقالة يتضمن المحول. يجب أن يقوم المحول بمصادقة نفسه لإجراء الاتصالات التالية:

- اتصال بـ Dataverse
- اتصال بنظام التكامل

انظر إلى حدود النظام في الرسم التخطيطي. يجب أن تتم مصادقة كل طلب ويب بين الأنظمة، ويجب تمرير تدقيقات التخويل علي مستوي التطبيق قبل إرجاع البيانات إلى مجرى الاتصال. لطلب مقابل الجدول الظاهري Dynamics 365 الذي تم نسخه احتياطيًا بواسطة الموارد المالية أو الموارد البشرية، يتم فرض تدقيق المصادقة والتخويل بحدود النظام التالية:

- الاتصال بين المحول ونقطة نهاية API للويب Dataverse (OData)
- الاتصال بين أداه الوحدة الإضافية لعنصر Dataverse الظاهري وخدمة العناصر الظاهرة للموارد المالية أو البشرية

وفي كلتا الحالتين، يتم إجراء عمليات المصادقة أولاً. ثم يتم إجراء تدقيقات التخويل علي مستوي التطبيق للتأكد من أن المستخدم أو التطبيق المصادق يتمتع بالامتيازات الصحيحة علي مستوي التطبيق لاسترداد البيانات المطلوبة.

تتم معالجة المصادقة للاتصال بـ Dataverse من خلال أحد الرموز المميزة للحامل والتي يجب تضمينها كعنوان HTTP في طلب الويب Dataverse. يجب أن يحصل المحول علي رمز مميّز من مثيل المستأجر B Azure AD. راجع "1. الحصول علي الرمز المميز "في الرسم التخطيطي.) Azure AD يعمل كموفر الهوية في تدفق المصادقة.

يصادق المحول من خلال توفير هوية التطبيق الخاص به (غير السرية، كما هو مسجل في المستأجر A Azure AD ) وسر التطبيق أو الشهادة التي يمتلكها تطبيق المحول فقط.

بعد أن تتم المصادقة علي المستخدم أو التطبيق لإجراء اتصال بـ Dataverse، يتم إجراء تدقيقات التخويل علي مستوي أداء Dataverse الخاص بكل طلب. وتقوم عمليات التدقيق هذه بالتأكد من أن المتصل (هوية تطبيق المحول، والذي تم تعيينه "\<guid A\>" في الرسم التخطيطي) لديه أذونات التطبيق المناسبة. تتم إداره التخويل Dataverse علي مستوي التطبيق من خلال مستخدم التطبيق الذي يمثل معرف تطبيق المحول. تتم إداره أذونات مستوي التطبيق من خلال منح حق الوصول إلى أدوار التطبيقات المحددة وفق Dataverse. توفر هذه الأدوار امتيازات الدقة للتطبيق.

للحصول على إرشادات أكثر تفصيلاً ، راجع [استخدام مصادقة خادم إلى خادم من مستأجرين متعددين](/power-apps/developer/data-platform/use-multi-tenant-server-server-authentication)

إذا تم اجتياز عمليات التحقق من أذونات التطبيق على مستوى Dataverse، فإن المكون الإضافي للعنصر الظاهري يقوم باستدعاء لنقطة نهاية خدمة الوحدة الظاهرية في بيئة الموارد المالية أو الموارد البشرية. يتم استخدام مصادقة خادم إلى خادم (S2S) لإجراء هذا الاتصال. يستخدم الهوية والسر الذي تم تكوينه في سجل تكوين مصدر البيانات الظاهري المالية والعمليات.

![سجل تكوين مصدر البيانات الظاهري المالية والعمليات في بيئة الاختبار المعزول.](./media/sandbox.jpg)

لمزيد من المعلومات، راجع [تكوين كيانات Dataverse الظاهرية](/dev-itpro/power-platform/admin-reference).

يتضمن الاتصال من المكون الإضافي للعنصر الظاهري Dataverse للموارد المالية أو البشرية هوية المحول الخاصة بالاتصال الأصلي إلى Dataverse من المحول (الهوية المعينة "\<guid A\>" في الرسم التخطيطي المعماري). إذا تم تكوين مصدر بيانات العنصر الظاهري بشكل صحيح، ونجحت عملية التحقق من مصادقة S2S، ستقوم خدمه العنصر الظاهري في الموارد المالية أو الموارد البشرية بتشغيل الاستعلام في سياق مجري الاتصال الأصلي (المحول، \<guid A\>). سيتم إجراء عمليات التحقق من أذونات التطبيق (التخويل) في مستوي الموارد المالية أو البشرية لضمان أن المحول لديه الامتيازات المطلوبة للوصول إلى عناصر البيانات التي يتم طلبها من خلال الاستعلام.

تتم إداره أمان الموارد المالية والبشرية بالطرق التالية:

1. من خلال تعيين هوية المحول (\<guid A\>) إلى مستخدم موارد مالية أو بشرية معين. يتم القيام بهذا التعيين في الصفحة **تطبيقات Azure active directory**. لمزيد من المعلومات، راجع [سجل طلبك الخارجي](/dev-itpro/data-entities/services-home-page.md#register-your-external-application).
2. ومن خلال منح مستخدم الموارد المالية أو البشرية الأدوار والواجبات والامتيازات المناسبة على مستوى التطبيق. لمزيد من المعلومات، راجع [الأمان المستند إلى الدور](/dev-itpro/sysadmin/role-based-security).

إذا تم منح تطبيق المحول (\<guid A\>) الامتيازات المطلوبة للوصول إلى البيانات المطلوبة، يتم إجراء الأحداث التالية:

1. الاستعلام قيد التشغيل.
2. تتم ترجمة البيانات مرة أخرى إلى صفحة العنصر الخاص بـ Dataverse.
3. يتم إرجاع البيانات إلى المحول.

> [!IMPORTANT]
> وأثناء التطوير، يمكن تشغيل المحول باستخدام مستخدم الموارد المالية أو البشرية التي لديها دور المسؤول. ومع ذلك، يجب ألا يتم تشغيل المحول بامتيازات مسؤول في بيئة التشغيل.

## <a name="key-takeaways"></a>المآخذ الرئيسية

فيما يلي بعض العواقب المهمة للبنية الخاصة بالجدول أو العنصر الظاهر:

- يتم إداره تكوين الأمان للجداول الظاهرية المدعومة بواسطة الموارد البشرية في الموارد البشرية.
- يتوفر للعميل ("عميل متبادل" في الرسم التخطيطي المعماري المذكور مسبقًا في هذه المقالة) التحكم الكامل بالامتيازات التي يتم منحها لتكامل المحول المتكامل (المعين "\<guid A\>" في الرسم التخطيطي).
- تقع على العميل مسؤولية تكوين الأمان الصحيح لبيئة الموارد البشرية الخاصة بهم. يجب أن يقدم الشريك المتكامل الذي ينشئ المحول إرشادات حول الامتيازات التي يتطلبها المحول.
