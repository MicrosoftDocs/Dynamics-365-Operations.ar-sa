---
title: عرض بيانات الكيان وتحديثها باستخدام Excel
description: يشرح هذا الموضوع كيفية فتح بيانات الكيان في Microsoft Excel, ثم عرض وتحديث وتحرير البيانات باستخدام الوظيفة الإضافية Microsoft Dynamics لوظيفة Excel الإضافية.
author: jasongre
manager: AnnBe
ms.date: 01/22/2021
ms.topic: article
ms.prod: ''
ms.service: dynamics-ax-platform
ms.technology: ''
audience: Application User
ms.reviewer: sericks
ms.custom: 267914
ms.assetid: 4e6c7194-a059-4057-bd62-ec0c802c36fd
ms.search.region: Global
ms.author: jasongre
ms.search.validFrom: 2016-02-28
ms.dyn365.ops.version: AX 7.0.0
ms.openlocfilehash: 0a9486b3d700cdbe19fbcdba431f673d0a03014f
ms.sourcegitcommit: ca05440ee503bf15fe98fe138d317c1cdf21ad16
ms.translationtype: HT
ms.contentlocale: ar-SA
ms.lasthandoff: 02/09/2021
ms.locfileid: "5141866"
---
# <a name="view-and-update-entity-data-with-excel"></a><span data-ttu-id="85220-103">عرض بيانات الكيان وتحديثها باستخدام Excel</span><span class="sxs-lookup"><span data-stu-id="85220-103">View and update entity data with Excel</span></span> 

[!include [banner](../includes/banner.md)]
[!include [preview banner](../includes/preview-banner.md)]

<span data-ttu-id="85220-104">يشرح هذا الموضوع كيفية فتح بيانات الكيان في Microsoft Excel, ثم عرض وتحديث وتحرير البيانات باستخدام الوظيفة الإضافية Microsoft Dynamics لوظيفة Excel الإضافية.</span><span class="sxs-lookup"><span data-stu-id="85220-104">This topic explains how to open entity data in Microsoft Excel, and then view, update, and edit the data by using the Microsoft Dynamics Excel add-in.</span></span> <span data-ttu-id="85220-105">لفتح كيان البيانات، يمكنك البدء إما من Excel أو من تطبيقات Finance and Operations.</span><span class="sxs-lookup"><span data-stu-id="85220-105">To open entity data, you can start from either Excel or Finance and Operations apps.</span></span>

<span data-ttu-id="85220-106">من خلال فتح بيانات الكيان في Excel، يمكنك أن تقوم بسرعة وسهولة بعرض وتحرير البيانات باستخدام وظيفة Excel الإضافية.</span><span class="sxs-lookup"><span data-stu-id="85220-106">By opening entity data in Excel, you can quickly and easily view and edit the data by using the Excel add-in.</span></span> <span data-ttu-id="85220-107">هذه الوظيفة الإضافية برنامج Microsoft Excel 2016 أو أحدث.</span><span class="sxs-lookup"><span data-stu-id="85220-107">This add-in requires Microsoft Excel 2016 or later.</span></span>

> [!NOTE]
> <span data-ttu-id="85220-108">إذا تم تكوين مستأجر Microsoft Azure Active Directory (Azure AD) لاستخدام خدمات الأمان المشترك لـ Active Directory‬ (أو AD FS)، فيجب التأكد من تطبيق تحديث مايو 2016 لـ Office، لتمكين وظيفة Excel الإضافية من تسجيل دخولك بشكل صحيح.</span><span class="sxs-lookup"><span data-stu-id="85220-108">If your Microsoft Azure Active Directory (Azure AD) tenant is configured to use Active Directory Federation Services (AD FS), you must make sure that the May 2016 update for Office has been applied, so that the Excel add-in can correctly sign you in.</span></span>

<span data-ttu-id="85220-109">لمزيد من المعلومات حول استخدام وظيفة Excel الإضافية، شاهد الفيديو القصير [إنشاء قالب Excel لأنماط الرؤوس والبنود](https://youtu.be/RTicLb-6dbI) .</span><span class="sxs-lookup"><span data-stu-id="85220-109">To learn more about how to use the Excel add-in, watch the short [Create an Excel template for header and line patterns](https://youtu.be/RTicLb-6dbI) video.</span></span>

## <a name="open-entity-data-in-excel-when-you-start-from-a-finance-and-operations-app"></a><span data-ttu-id="85220-110">فتح بيانات الكيان في Excel عند بدء التشغيل من تطبيق Finance and Operations</span><span class="sxs-lookup"><span data-stu-id="85220-110">Open entity data in Excel when you start from a Finance and Operations app</span></span>
1. <span data-ttu-id="85220-111">في صفحة في تطبيق Finance and Operations، حدد **فتح في Microsoft Office**.</span><span class="sxs-lookup"><span data-stu-id="85220-111">On a page in a Finance and Operations app, select **Open in Microsoft Office**.</span></span>

    <span data-ttu-id="85220-112">إذا كان مصدر البيانات الجذر (الجدول) للصفحة هو نفسه مصدر البيانات الجذر لأي كيانات، فسيتم إنشاء خيارات **فتح في Excel** الافتراضية للصفحة.</span><span class="sxs-lookup"><span data-stu-id="85220-112">If the root data source (table) for the page is the same as the root data source for any entities, default **Open in Excel** options are generated for the page.</span></span> <span data-ttu-id="85220-113">يمكن العثور على خيارات **فتح في Excel** على الصفحات المستخدمة بشكل متكرر، مثل **كافة الموردين** و **كافة العملاء**.</span><span class="sxs-lookup"><span data-stu-id="85220-113">**Open in Excel** options can be found on frequently used pages, such as **All vendors** and **All customers**.</span></span>
 
2. <span data-ttu-id="85220-114">حدد أحد خيارات **فتح في Excel**، وافتح المصنف الذي يتم إنشاؤه.</span><span class="sxs-lookup"><span data-stu-id="85220-114">Select an **Open in Excel** option, and open the workbook that is generated.</span></span> <span data-ttu-id="85220-115">يحتوي هذا المصنف على معلومات ربط للكيان ومؤشر إلى بيئتك ومؤشر إلى وظيفة Excel الإضافية.</span><span class="sxs-lookup"><span data-stu-id="85220-115">This workbook has binding information for the entity, a pointer to your environment, and a pointer to the Excel add-in.</span></span>
3. <span data-ttu-id="85220-116">في Excel، حدد **تمكين التحرير** لتمكين تشغيل وظيفة Excel الإضافية.</span><span class="sxs-lookup"><span data-stu-id="85220-116">In Excel, select **Enable editing** to enable the Excel add-in to run.</span></span> <span data-ttu-id="85220-117">يتم تشغيل وظيفة Excel الإضافية في جزء يقع على الجانب الأيسر من نافذة Excel.</span><span class="sxs-lookup"><span data-stu-id="85220-117">The Excel add-in runs in a pane on the right side of the Excel window.</span></span>
4. <span data-ttu-id="85220-118">إذا كنت تقوم بتشغيل وظيفة Excel الإضافية للمرة الأولى، فحدد **الثقة بهذه الوظيفة الإضافية**.</span><span class="sxs-lookup"><span data-stu-id="85220-118">If you're running the Excel add-in for the first time, select **Trust this Add-in**.</span></span>
5. <span data-ttu-id="85220-119">في حالة مطالبتك بتسجيل الدخول، حدد **تسجيل الدخول**، وبعد ذلك سجّل الدخول باستخدام نفس بيانات الاعتماد التي استخدمتها لتسجيل الدخول إلى تطبيق Finance and Operations.</span><span class="sxs-lookup"><span data-stu-id="85220-119">If you're prompted to sign in, select **Sign in**, and then sign in by using the same credentials that you used to sign in to the Finance and Operations app.</span></span> <span data-ttu-id="85220-120">سوف تستخدم وظيفة Excel الإضافية سياق تسجيل الدخول السابق من المستعرض وتسجّل دخولك تلقائيًا إليها، إذا أمكنها ذلك.</span><span class="sxs-lookup"><span data-stu-id="85220-120">The Excel add-in will use a previous sign-in context from the browser and automatically sign you in, if it can.</span></span> <span data-ttu-id="85220-121">(للحصول علي معلومات حول المستعرض الذي يتم استخدامه استنادا إلى نظام التشغيل، راجع [المستعرضات التي تستخدمها وظائف Office الاضافيه](https://docs.microsoft.com/office/dev/add-ins/concepts/browsers-used-by-office-web-add-ins.)للتاكد من نجاح تسجيل الدخول، تحقق من اسم المستخدم في الركن الأيسر العلوي لوظيفة Excel الاضافيه.</span><span class="sxs-lookup"><span data-stu-id="85220-121">(For information about the browser that is used based on the operating system, see [Browsers used by Office add-ins](https://docs.microsoft.com/office/dev/add-ins/concepts/browsers-used-by-office-web-add-ins.) To ensure that sign-in was successful, verify the user name in the upper-right corner of the Excel add-in.</span></span> 

<span data-ttu-id="85220-122">تقرأ وظيفة Excel الإضافية بشكل تلقائي البيانات للكيان الذي قمت بتحديده.</span><span class="sxs-lookup"><span data-stu-id="85220-122">The Excel add-in automatically reads the data for the entity that you selected.</span></span> <span data-ttu-id="85220-123">لاحظ أن المصنف لن يتضمن أي بيانات إلى أن تقوم وظيفة Excel الإضافية بقراءتها فيه.</span><span class="sxs-lookup"><span data-stu-id="85220-123">Note that there will be no data in the workbook until the Excel add-in reads it in.</span></span>

## <a name="open-entity-data-in-excel-when-you-start-from-excel"></a><span data-ttu-id="85220-124">فتح بيانات الكيان في Excel عند بدء التشغيل من Excel</span><span class="sxs-lookup"><span data-stu-id="85220-124">Open entity data in Excel when you start from Excel</span></span>
1. <span data-ttu-id="85220-125">في Excel، على علامة التبويب **إدراج**، في مجموعة **الوظائف الإضافية**، حدد **متجر** لفتح متجر Office.</span><span class="sxs-lookup"><span data-stu-id="85220-125">In Excel, on the **Insert** tab, in the **Add-ins** group, select **Store** to open the Office Store.</span></span>
2. <span data-ttu-id="85220-126">في متجر Office، ابحث عن الكلمة الأساسية **Dynamics**، ثم حدد **إضافة‏‎** إلى جانب **وظيفة Microsoft Dynamics Office الإضافية** (وظيفة Excel الإضافية).</span><span class="sxs-lookup"><span data-stu-id="85220-126">In the Office Store, search on the keyword **Dynamics**, and then select **Add** next to **Microsoft Dynamics Office Add-in** (the Excel add-in).</span></span>
3. <span data-ttu-id="85220-127">إذا كنت تقوم بتشغيل وظيفة Excel الإضافية للمرة الأولى، فحدد **الثقة بهذه الوظيفة الإضافية** لتمكين تشغيل وظيفة Excel الإضافية.</span><span class="sxs-lookup"><span data-stu-id="85220-127">If you're running the Excel add-in for the first time, select **Trust this Add-in** to enable the Excel add-in to run.</span></span> <span data-ttu-id="85220-128">يتم تشغيل وظيفة Excel الإضافية في جزء يقع على الجانب الأيسر من نافذة Excel.</span><span class="sxs-lookup"><span data-stu-id="85220-128">The Excel add-in runs in a pane on the right side of the Excel window.</span></span>
4. <span data-ttu-id="85220-129">حدد **إضافة معلومات الخادم** لفتح الجزء **خيارات**.</span><span class="sxs-lookup"><span data-stu-id="85220-129">Select **Add server information** to open the **Options** pane.</span></span>
5. <span data-ttu-id="85220-130">في المستعرض، انسخ عنوان URL لمثيل تطبيق Finance and Operations الهدف، والصقه في حقل **عنوان URL للخادم**، ثم احذف كل شيء بعد اسم المضيف.</span><span class="sxs-lookup"><span data-stu-id="85220-130">In your browser, copy the URL of your target Finance and Operations app instance, paste it into the **Server URL** field, and then delete everything after the host name.</span></span> <span data-ttu-id="85220-131">يجب أن يتضمن عنوان URL الناتج فقط اسم المضيف.</span><span class="sxs-lookup"><span data-stu-id="85220-131">The resulting URL should have only the host name.</span></span>

    <span data-ttu-id="85220-132">على سبيل المثال، إذا كان عنوان URL `https://xxx.dynamics.com/?cmp=usmf&amp;mi=CustTableListPage`، فاحذف كل شيء باستثناء `https://xxx.dynamics.com`.</span><span class="sxs-lookup"><span data-stu-id="85220-132">For example, if the URL is `https://xxx.dynamics.com/?cmp=usmf&amp;mi=CustTableListPage`, delete everything except `https://xxx.dynamics.com`.</span></span>

6. <span data-ttu-id="85220-133">حدد **موافق**، ثم حدد **نعم** لتأكيد التغيير.</span><span class="sxs-lookup"><span data-stu-id="85220-133">Select **OK**, and then select **Yes** to confirm the change.</span></span> <span data-ttu-id="85220-134">يبدأ تشغيل وظيفة Excel الإضافية من جديد وتقوم بتحميل بيانات التعريف.</span><span class="sxs-lookup"><span data-stu-id="85220-134">The Excel add-in is restarted and loads metadata.</span></span>

    <span data-ttu-id="85220-135">يتوفر الآن الزر **تصميم**.</span><span class="sxs-lookup"><span data-stu-id="85220-135">The **Design** button is now available.</span></span> <span data-ttu-id="85220-136">إذا تضمنت وظيفة Excel الإضافية الزر **تحميل البرامج‬**، فهذا يعني على الأرجح أنك لم تسجل دخولك كمستخدم صحيح.</span><span class="sxs-lookup"><span data-stu-id="85220-136">If the Excel add-in has a **Load applets** button, you probably aren't signed in as the correct user.</span></span> <span data-ttu-id="85220-137">لمزيد من المعلومات، راجع "ظهور زر تحميل البرامج" في قسم [استكشاف الأخطاء وإصلاحها](https://docs.microsoft.com/dynamics365/unified-operations/dev-itpro/office-integration/use-excel-add-in#troubleshooting) في هذا الموضوع.</span><span class="sxs-lookup"><span data-stu-id="85220-137">For more information, see "The Load applets button is shown" in the [Troubleshooting](https://docs.microsoft.com/dynamics365/unified-operations/dev-itpro/office-integration/use-excel-add-in#troubleshooting) section of this topic.</span></span>

7. <span data-ttu-id="85220-138">حدد **تصميم**.</span><span class="sxs-lookup"><span data-stu-id="85220-138">Select **Design**.</span></span> <span data-ttu-id="85220-139">تقوم وظيفة Excel الإضافية باسترداد بيانات تعريف الكيان.</span><span class="sxs-lookup"><span data-stu-id="85220-139">The Excel add-in retrieves entity metadata.</span></span>
8. <span data-ttu-id="85220-140">حدد **إضافة جدول**.</span><span class="sxs-lookup"><span data-stu-id="85220-140">Select **Add table**.</span></span> <span data-ttu-id="85220-141">تظهر قائمة بالكيانات.</span><span class="sxs-lookup"><span data-stu-id="85220-141">A list of entities appears.</span></span> <span data-ttu-id="85220-142">تكون الكيانات مدرجة بصيغة "الاسم - التسمية".</span><span class="sxs-lookup"><span data-stu-id="85220-142">The entities are listed in "Name - Label" format.</span></span>
9. <span data-ttu-id="85220-143">حدد كيانًا في القائمة، مثل **العميل-العملاء**، ثم حدد **التالي**.</span><span class="sxs-lookup"><span data-stu-id="85220-143">Select an entity in the list, such as **Customer - Customers**, and then select **Next**.</span></span>
10. <span data-ttu-id="85220-144">لإضافة حقل من قائمة **الحقول المتوفرة** إلى قائمة **الحقول المحددة**، حدد الحقل، ثم حدد **إضافة**.</span><span class="sxs-lookup"><span data-stu-id="85220-144">To add a field from the **Available fields** list to the **Selected fields** list, select the field, and then select **Add**.</span></span> <span data-ttu-id="85220-145">بدلاً من ذلك، انقر نقراً مزدوجاً فوق الحقل في القائمة **الحقول المتوفرة**.</span><span class="sxs-lookup"><span data-stu-id="85220-145">Alternatively, double-click the field in the **Available fields** list.</span></span>
11. <span data-ttu-id="85220-146">بعد أن تنتهي من إضافة الحقول المطلوبة إلى قائمة **الحقول المحددة**، تأكد من وجود المؤشر في المكان الصحيح في ورقة العمل (على سبيل المثال، الخلية A1)، ثم حدد **تم**.</span><span class="sxs-lookup"><span data-stu-id="85220-146">After you've finished adding fields to the **Selected fields** list, make sure that the cursor is in the correct place in the worksheet (for example, cell A1), and then select **Done**.</span></span> <span data-ttu-id="85220-147">بعد ذلك، حدد **تم** لإغلاق المصمم.</span><span class="sxs-lookup"><span data-stu-id="85220-147">Then select **Done** to exit the designer.</span></span>
12. <span data-ttu-id="85220-148">حدد **تحديث** لسحب مجموعة من البيانات.</span><span class="sxs-lookup"><span data-stu-id="85220-148">Select **Refresh** to pull in a set of data.</span></span>

## <a name="view-and-update-entity-data-in-excel"></a><span data-ttu-id="85220-149">عرض بيانات الكيان وتحديثها في Excel</span><span class="sxs-lookup"><span data-stu-id="85220-149">View and update entity data in Excel</span></span>
<span data-ttu-id="85220-150">بعد أن تقوم وظيفة Excel الإضافية بقراءة بيانات الكيان في المصنف، يمكنك تحديث البيانات في أي وقت بتحديد **تحديث** في وظيفة Excel الإضافية.</span><span class="sxs-lookup"><span data-stu-id="85220-150">After the Excel add-in reads entity data into the workbook, you can update the data at any time by selecting **Refresh** in the Excel add-in.</span></span>

## <a name="edit-entity-data-in-excel"></a><span data-ttu-id="85220-151">تحرير بيانات الكيان في Excel</span><span class="sxs-lookup"><span data-stu-id="85220-151">Edit entity data in Excel</span></span>
<span data-ttu-id="85220-152">يمكنك تغيير بيانات الكيان وفق احتياجاتك، ثم إعادة نشرها في تطبيقات Finance and Operations بتحديد **نشر** في وظيفة Excel الإضافية.</span><span class="sxs-lookup"><span data-stu-id="85220-152">You can change entity data as you require and then publish it back to Finance and Operations apps by selecting **Publish** in the Excel add-in.</span></span> <span data-ttu-id="85220-153">لتحرير سجل، حدد خلية في ورقة العمل ثم قم بتغيير قيمة الخلية.</span><span class="sxs-lookup"><span data-stu-id="85220-153">To edit a record, select a cell in the worksheet, and then change the cell value.</span></span> <span data-ttu-id="85220-154">لإضافة سجل جديد، اتبع إحدى الخطوات التالية:</span><span class="sxs-lookup"><span data-stu-id="85220-154">To add a new record, follow one of these steps:</span></span>

- <span data-ttu-id="85220-155">انقر في أي مكان في جدول مصادر البيانات، ثم حدد **جديد** في وظيفة Excel الإضافية.</span><span class="sxs-lookup"><span data-stu-id="85220-155">Click anywhere in the data sources table, and then select **New** in the Excel add-in.</span></span>
- <span data-ttu-id="85220-156">انقر بأي مكان في الصف الأخير من جدول مصادر البيانات، ثم اضغط المفتاح Tab حتى خروج المؤشر من العمود الأخير لذلك الصف وإنشاء صف جديد.</span><span class="sxs-lookup"><span data-stu-id="85220-156">Click anywhere in the last row of the data sources table, and then press the Tab key until the cursor moves out of the last column of that row and a new row is created.</span></span>
- <span data-ttu-id="85220-157">انقر بأي مكان في الصف مباشرة أسفل جدول مصادر البيانات، وابدأ إدخال بيانات في خلية.</span><span class="sxs-lookup"><span data-stu-id="85220-157">Click anywhere in the row immediately below the data sources table, and start to enter data in a cell.</span></span> <span data-ttu-id="85220-158">عند نقل التركيز من هذه الخلية، يتوسع الجدول لتضمين الصف الجديد.</span><span class="sxs-lookup"><span data-stu-id="85220-158">When you move the focus out of that cell, the table expands to include the new row.</span></span>
- <span data-ttu-id="85220-159">فيما يتعلق بروابط الحقول لسجلات الرأس، حدد أحد الحقول، ثم حدد **جديد** في وظيفة Excel الإضافية.</span><span class="sxs-lookup"><span data-stu-id="85220-159">For field bindings of header records, select one of the fields, and then select **New** in the Excel add-in.</span></span>

<span data-ttu-id="85220-160">لاحظ أنه يمكن إنشاء سجل جديد فقط إذا كانت كافة الحقول الأساسية والإلزامي مرتبطة في ورقة العمل، أو إذا تم إدخال القيم الافتراضية باستخدام شرط عامل التصفية.</span><span class="sxs-lookup"><span data-stu-id="85220-160">Note that a new record can be created only if all the key and mandatory fields are bound in the worksheet, or if default values were filled in by using the filter condition.</span></span>

<span data-ttu-id="85220-161">لحذف سجل، اتبع إحدى الخطوات التالية:</span><span class="sxs-lookup"><span data-stu-id="85220-161">To delete a record, follow one of these steps:</span></span>

- <span data-ttu-id="85220-162">انقر بزر الماوس الأيمن فوق رقم الصف الموجود بجانب صف ورقة العمل الذي تريد حذفه، ثم حدد **حذف**.</span><span class="sxs-lookup"><span data-stu-id="85220-162">Right-click the row number next to the worksheet row that should be deleted, and then select **Delete**.</span></span>
- <span data-ttu-id="85220-163">انقر بزر الماوس الأيمن في أي مكان في صف ورقة العمل الذي تريد حذفه، ثم حدد **حذف** &gt; **صفوف الجدول**.</span><span class="sxs-lookup"><span data-stu-id="85220-163">Right-click anywhere in the worksheet row that should be deleted, and then select **Delete** &gt; **Table Rows**.</span></span>

<span data-ttu-id="85220-164">إذا تمت إضافة مصادر البيانات على أنها مصادر بيانات مرتبطة، فسيتم نشر الرأس قبل البنود.</span><span class="sxs-lookup"><span data-stu-id="85220-164">If data sources have been added as related data sources, the header is published before the lines.</span></span> <span data-ttu-id="85220-165">في حال وجود تبعيات بين مصادر بيانات الأخرى، قد تحتاج إلى تغيير أمر النشر الافتراضي.</span><span class="sxs-lookup"><span data-stu-id="85220-165">If there are dependencies between other data sources, you might have to change the default publishing order.</span></span> <span data-ttu-id="85220-166">‏‫لتغيير أمر النشر، في وظيفة Excel الإضافية، حدد الزر **خيارات** (رمز الترس)، وبعد ذلك، في علامة التبويب السريعة **موصل البيانات**، حدد **تكوين أمر نشر‬**.</span><span class="sxs-lookup"><span data-stu-id="85220-166">To change the publishing order, in the Excel add-in, select the **Options** button (the gear symbol), and then, on the **Data Connector** FastTab, select **Configure publish order**.</span></span>

## <a name="add-or-remove-columns"></a><span data-ttu-id="85220-167">إضافة الأعمدة أو إزالتها</span><span class="sxs-lookup"><span data-stu-id="85220-167">Add or remove columns</span></span>
<span data-ttu-id="85220-168">يمكنك استخدام المصمم لضبط الأعمدة التي تُضاف تلقائيًا إلى ورقة العمل.</span><span class="sxs-lookup"><span data-stu-id="85220-168">You can use the designer to adjust the columns that are automatically added to the worksheet.</span></span>

> [!NOTE]
> <span data-ttu-id="85220-169">إذا كان زر **التصميم** لا يظهر أسفل زر **عامل التصفية** في وظيفة Excel الإضافية، يجب تمكين مصمم مصدر البيانات.</span><span class="sxs-lookup"><span data-stu-id="85220-169">If the **Design** button doesn't appear below the **Filter** button in the Excel add-in, you must enable the data source designer.</span></span> <span data-ttu-id="85220-170">حدد الزر **خيارات** (رمز الترس)، ثم حدد خانة الاختيار **تمكين التصميم**.</span><span class="sxs-lookup"><span data-stu-id="85220-170">Select the **Options** button (the gear symbol), and then select the **Enable design** check box.</span></span>

1. <span data-ttu-id="85220-171">في وظيفة Excel الإضافية، حدد **تصميم**.</span><span class="sxs-lookup"><span data-stu-id="85220-171">In the Excel add-in, select **Design**.</span></span> <span data-ttu-id="85220-172">يتم سرد كافة مصادر البيانات.</span><span class="sxs-lookup"><span data-stu-id="85220-172">All the data sources are listed.</span></span>
2. <span data-ttu-id="85220-173">إلى جانب مصدر البيانات، حدد الزر **تحرير** (رمز القلم).</span><span class="sxs-lookup"><span data-stu-id="85220-173">Next to the data source, select the **Edit** button (the pencil symbol).</span></span>
3. <span data-ttu-id="85220-174">في قائمة **الحقول المحددة**، اضبط قائمة الحقول وفق احتياجاتك:</span><span class="sxs-lookup"><span data-stu-id="85220-174">In the **Selected fields** list, adjust the list of fields as you require:</span></span>

    - <span data-ttu-id="85220-175">لإضافة حقل من قائمة **الحقول المتوفرة** إلى قائمة **الحقول المحددة**، حدد الحقل، ثم حدد **إضافة**.</span><span class="sxs-lookup"><span data-stu-id="85220-175">To add a field from the **Available fields** list to the **Selected fields** list, select the field, and then select **Add**.</span></span> <span data-ttu-id="85220-176">بدلاً من ذلك، انقر نقراً مزدوجاً فوق الحقل في القائمة **الحقول المتوفرة**.</span><span class="sxs-lookup"><span data-stu-id="85220-176">Alternatively, double-click the field in the **Available fields** list.</span></span>
    - <span data-ttu-id="85220-177">لإزالة حقل من قائمة **الحقول المحددة**، حدد الحقل، ثم حدد **إزالة**.</span><span class="sxs-lookup"><span data-stu-id="85220-177">To remove a field from the **Selected fields** list, select the field, and then select **Remove**.</span></span> <span data-ttu-id="85220-178">أو انقر نقرًا مزدوجًا فوق الحقل.</span><span class="sxs-lookup"><span data-stu-id="85220-178">Alternatively, double-click the field.</span></span>
    - <span data-ttu-id="85220-179">لتغيير ترتيب الحقول في قائمة **الحقول المحددة**، حدد حقل، ثم حدد **أعلى** أو **أسفل**.</span><span class="sxs-lookup"><span data-stu-id="85220-179">To change the order of fields in the **Selected fields** list, select a field, and then select **Up** or **Down**.</span></span>

4. <span data-ttu-id="85220-180">لتطبيق التغييرات على مصدر البيانات، حدد **تحديث**.</span><span class="sxs-lookup"><span data-stu-id="85220-180">To apply your changes to the data source, select **Update**.</span></span> <span data-ttu-id="85220-181">بعد ذلك، حدد **تم** لإغلاق المصمم.</span><span class="sxs-lookup"><span data-stu-id="85220-181">Then select **Done** to exit the designer.</span></span>
5. <span data-ttu-id="85220-182">إذا قمت بإضافة حقل (عمود)، فحدد **تحديث** لسحب مجموعة محدّثة من البيانات.</span><span class="sxs-lookup"><span data-stu-id="85220-182">If you added a field (column), select **Refresh** to pull in an updated set of data.</span></span>

## <a name="change-the-publish-batch-size"></a><span data-ttu-id="85220-183">تغيير حجم دفعه النشر</span><span class="sxs-lookup"><span data-stu-id="85220-183">Change the publish batch size</span></span>
<span data-ttu-id="85220-184">عند قيام المستخدمين بنشر التغييرات علي سجلات البيانات باستخدام وظيفة Excel الاضافيه، يتم إرسال التحديثات في مجموعات.</span><span class="sxs-lookup"><span data-stu-id="85220-184">When users publish changes to data records by using the Excel add-in, the updates are submitted in batches.</span></span> <span data-ttu-id="85220-185">يكون حجم دفعه النشر الافتراضي 100 صفا.</span><span class="sxs-lookup"><span data-stu-id="85220-185">The default publish batch size is 100 rows.</span></span> <span data-ttu-id="85220-186">في الإصدار 10.0.17 والإصدارات الأحدث، توفر لك ميزة **السماح بتكوين حجم الدفعة الاضافيه للنشر في وظيفة Excel الاضافيه** تحكما مرنا في حجم دفعه النشر.</span><span class="sxs-lookup"><span data-stu-id="85220-186">In version 10.0.17 and later, the **Allow configuration of the publish batch size in the Excel add-in** feature gives you flexible control over the publish batch size.</span></span>

<span data-ttu-id="85220-187">يمكن لمسؤولي النظام تحديد حد واسع النظام علي المصنف "فتح في Excel" وذلك باعداد الحقل **الحد من مجموعه الدفعات** في قسم **معلمات التطبيق** في الصفحة **معلمات تطبيق Office**.</span><span class="sxs-lookup"><span data-stu-id="85220-187">System administrators can specify a system-wide limit on the publish batch size for "Open in Excel" workbooks by setting the **Publish batch limit** field in the **App parameters** section of the **Office app parameters** page.</span></span>

<span data-ttu-id="85220-188">يمكن أيضا تغيير حجم دفعه النشر لمصنف فردي باستخدام وظيفة Excel الاضافيه.</span><span class="sxs-lookup"><span data-stu-id="85220-188">The publish batch size can also be changed for an individual workbook by using the Excel add-in.</span></span>

1. <span data-ttu-id="85220-189">افتح المصنف في Excel.</span><span class="sxs-lookup"><span data-stu-id="85220-189">Open the workbook in Excel.</span></span>
2. <span data-ttu-id="85220-190">حدد زر **الإعدادات** (أيقونة الترس) في الركن العلوي الأيسر من وظيفة Excel الإضافية.</span><span class="sxs-lookup"><span data-stu-id="85220-190">Select the **Option** (gear) button in the upper right of the Excel add-in.</span></span>
3. <span data-ttu-id="85220-191">قم بتعيين حقل **حجم دفعه النشر** حسب الرغبة.</span><span class="sxs-lookup"><span data-stu-id="85220-191">Set the **Publish batch size** field as desired.</span></span> <span data-ttu-id="85220-192">يجب ان تكون القيمة التي قمت بتعيينها اقل من حد مجموعه النشر علي مستوي النظام.</span><span class="sxs-lookup"><span data-stu-id="85220-192">The value that you set must be less than the system-wide publish batch limit.</span></span>
4. <span data-ttu-id="85220-193">حدد **موافق**.</span><span class="sxs-lookup"><span data-stu-id="85220-193">Select **OK**.</span></span>
5. <span data-ttu-id="85220-194">احفظ المصنف.</span><span class="sxs-lookup"><span data-stu-id="85220-194">Save the workbook.</span></span> <span data-ttu-id="85220-195">إذا لم تقم بحفظ المصنف بعد اجراء تغييرات علي إعدادات الوظيفة الاضافيه، لن تستمر هذه التغييرات عند أعاده فتح المصنف.</span><span class="sxs-lookup"><span data-stu-id="85220-195">If you don't save the workbook after you make changes to the add-in settings, those changes won't persist when the workbook is reopened.</span></span>

<span data-ttu-id="85220-196">يمكن لمؤلفي قوالب مصنف Excel استخدام نفس الاجراء لتعيين حجم مجموعه النشر للقوالب قبل قيامهم بتحميلها إلى النظام.</span><span class="sxs-lookup"><span data-stu-id="85220-196">Excel workbook template authors can use the same procedure to set the publish batch size for templates before they upload them into the system.</span></span>

## <a name="copy-environment-data"></a><span data-ttu-id="85220-197">نسخ بيانات البيئة</span><span class="sxs-lookup"><span data-stu-id="85220-197">Copy environment data</span></span>

<span data-ttu-id="85220-198">يمكن نسخ البيانات التي تتم قراءتها في المصنف من بيئة إلى بيئة أخرى.</span><span class="sxs-lookup"><span data-stu-id="85220-198">The data that is read into the workbook from one environment can be copied to another environment.</span></span> <span data-ttu-id="85220-199">مع ذلك، لا يمكنك تغيير عنوان URL الاتصال فحسب، نظرًا لأن ذاكرة التخزين المؤقت للبيانات في المصنف ستستمر في التعامل مع البيانات كبيانات موجودة.</span><span class="sxs-lookup"><span data-stu-id="85220-199">However, you can't just change the connection URL, because the data cache in the workbook will continue to treat the data as existing data.</span></span> <span data-ttu-id="85220-200">بدلاً من ذلك، يجب استخدام وظيفة نسخ بيانات البيئة‬ لنشر البيانات إلى بيئة جديدة كبيانات جديدة.</span><span class="sxs-lookup"><span data-stu-id="85220-200">Instead, you must use the Copy Environment Data functionality to publish the data to a new environment as new data.</span></span>

1. <span data-ttu-id="85220-201">حدد الزر **خيارات** (رمز الترس)، وبعد ذلك، في علامة التبويب السريعة‬ **‏‫موصل البيانات‬**، حدد **نسخ بيانات البيئة‬**.</span><span class="sxs-lookup"><span data-stu-id="85220-201">Select the **Options** button (the gear symbol), and then, on the **Data Connector** FastTab, select **Copy Environment Data**.</span></span> 
2. <span data-ttu-id="85220-202">أدخل عنوان URL للخادم لبيئة جديدة.</span><span class="sxs-lookup"><span data-stu-id="85220-202">Enter the server URL for the new environment.</span></span> 
3. <span data-ttu-id="85220-203">حدد **موافق**، ثم حدد **نعم** لتأكيد الإجراء.</span><span class="sxs-lookup"><span data-stu-id="85220-203">Select **OK**, and then select **Yes** to confirm the action.</span></span> <span data-ttu-id="85220-204">‏‫يبدأ تشغيل وظيفة Excel الإضافية من جديد وتتصل بالبيئة الجديدة.</span><span class="sxs-lookup"><span data-stu-id="85220-204">The Excel add-in is restarted and connects to the new environment.</span></span> <span data-ttu-id="85220-205">يتم التعامل مع أية بيانات موجودة في المصنف كبيانات جديدة.</span><span class="sxs-lookup"><span data-stu-id="85220-205">Any existing data in the workbook is treated as new data.</span></span>

    <span data-ttu-id="85220-206">بعد إعادة تشغيل وظيفة Excel الإضافية، يظهر مربع رسالة يفيد بأن المصنف موجود في وضع نسخة البيئة.</span><span class="sxs-lookup"><span data-stu-id="85220-206">After the Excel add-in is restarted, a message box states that the workbook is in Environment copy mode.</span></span>

4. <span data-ttu-id="85220-207">لنسخ البيانات إلى البيئة الجديدة كبيانات جديدة، حدد **نشر**.</span><span class="sxs-lookup"><span data-stu-id="85220-207">To copy the data into the new environment as new data, select **Publish**.</span></span> <span data-ttu-id="85220-208">لإلغاء عملية نسخ البيئة ومراجعة البيانات الموجودة في البيئة الجديدة، حدد **تحديث**.</span><span class="sxs-lookup"><span data-stu-id="85220-208">To cancel the environment copy operation and review the existing data in the new environment, select **Refresh**.</span></span>

## <a name="troubleshooting"></a><span data-ttu-id="85220-209">استكشاف الأخطاء وإصلاحها</span><span class="sxs-lookup"><span data-stu-id="85220-209">Troubleshooting</span></span>
<span data-ttu-id="85220-210">هناك بعض المشاكل التي يمكن حلها من خلال بعض الخطوات السهلة.</span><span class="sxs-lookup"><span data-stu-id="85220-210">There are a few issues that can be resolved through some easy steps.</span></span>

- <span data-ttu-id="85220-211">**‬‏‫ظهور زر تحميل البرامج** - إذا تضمنت وظيفة Excel الإضافية الزر **تحميل البرامج‬** بعد تسجيل الدخول، فهذا يعني على الأرجح أنك لم تسجل دخولك كمستخدم صحيح.</span><span class="sxs-lookup"><span data-stu-id="85220-211">**The Load applets button is shown** – If the Excel add-in has a **Load applets** button after sign-in, you probably aren't signed in as the correct user.</span></span> <span data-ttu-id="85220-212">لحل هذه المشكلة، تحقق من ظهور اسم المستخدم الصحيح في الزاوية اليسرى العليا من وظيفة Excel الإضافية.</span><span class="sxs-lookup"><span data-stu-id="85220-212">To resolve this issue, verify that the correct user name appears in the upper-right corner of the Excel add-in.</span></span> <span data-ttu-id="85220-213">إذا ظهر اسم مستخدم غير صحيح، فحدده، وسجّل خروجك، ثم سجّل دخولك مرة أخرى.</span><span class="sxs-lookup"><span data-stu-id="85220-213">If an incorrect user name appears, select it, sign out, and then sign back in.</span></span>
- <span data-ttu-id="85220-214">**‬‏‫تلقيت رسالة "ممنوع"** – إذا تلقيت رسالة "ممنوع" أثناء قيام وظيفة Excel الإضافية بتحميل بيانات التعريف، فهذا يعني أن الحساب الذي سجل دخوله إلى وظيفة Excel الإضافية لا يملك الأذونات الكافية لاستخدام الخدمة أو المثيل أو قاعدة البيانات المستهدفة.</span><span class="sxs-lookup"><span data-stu-id="85220-214">**You receive a "Forbidden" message** – If you receive a "Forbidden" message while the Excel add-in is loading metadata, the account that is signed in to the Excel add-in doesn't have permission to use the targeted service, instance, or database.</span></span> <span data-ttu-id="85220-215">لحل هذه المشكلة، تحقق من ظهور اسم المستخدم الصحيح في الزاوية اليسرى العليا من وظيفة Excel الإضافية.</span><span class="sxs-lookup"><span data-stu-id="85220-215">To resolve this issue, verify that the correct user name appears in the upper-right corner of the Excel add-in.</span></span> <span data-ttu-id="85220-216">إذا ظهر اسم مستخدم غير صحيح، فحدده، وسجّل خروجك، ثم سجّل دخولك مرة أخرى.</span><span class="sxs-lookup"><span data-stu-id="85220-216">If an incorrect user name appears, select it, sign out, and then sign back in.</span></span>
- <span data-ttu-id="85220-217">**‬‏‫ظهور صفحة ويب فارغة على Excel** – إذا تم فتح صفحة ويب فارغة أثناء عملية تسجيل الدخول، فهذا يعني أن الحساب يحتاج إلى AD FS، ولكن إصدار وظيفة Excel الإضافية الذي يقوم بتشغيل الوظيفة الإضافية ليس حديثًا بشكل كافٍ لكي يتمكن من تحميل مربع حوار تسجيل الدخول.</span><span class="sxs-lookup"><span data-stu-id="85220-217">**A blank webpage is shown over Excel** – If a blank webpage is opened during the sign-in process, the account requires AD FS, but the version of Excel that is running the Excel add-in isn't recent enough to load the sign-in dialog box.</span></span> <span data-ttu-id="85220-218">لحل هذه المشكلة، قم بتحديث إصدار Excel الذي تستخدمه.</span><span class="sxs-lookup"><span data-stu-id="85220-218">To resolve this issue, update the version of Excel that you're using.</span></span> <span data-ttu-id="85220-219">لتحديث إصدار Excel عندما تكون في مؤسسة موجودة على القناة المؤجلة، استخدم [أداة نشر Office](https://technet.microsoft.com/library/jj219422.aspx) من أجل [الانتقال من القناة المؤجلة إلى القناة الحالية](https://technet.microsoft.com/library/mt455210.aspx).</span><span class="sxs-lookup"><span data-stu-id="85220-219">To update the version of Excel when you're in an enterprise that is on the deferred channel, use the [Office deployment tool](https://technet.microsoft.com/library/jj219422.aspx) to [move from the deferred channel to the current channel](https://technet.microsoft.com/library/mt455210.aspx).</span></span>
- <span data-ttu-id="85220-220">**تتلقي مهله اثناء نشر تغييرات البيانات** – إذا تلقيت رسائل المهلة اثناء محاولة نشر تغييرات البيانات إلى أحد الكيانات، خذ بعين الاعتبار تقليل حجم الدفعة النشر للمصنف المتاثر.</span><span class="sxs-lookup"><span data-stu-id="85220-220">**You receive a time-out while you publish data changes** – If you receive time-out messages while you're trying to publish data changes to an entity, consider reducing the publish batch size for the affected workbook.</span></span> <span data-ttu-id="85220-221">قد تتطلب الكيانات التي تقوم بتشغيل قدر أكبر من المنطق في تغييرات السجلات إرسال تحديثات في مجموعات أصغر للمساعدة علي منع المهلات.</span><span class="sxs-lookup"><span data-stu-id="85220-221">Entities that trigger larger amounts of logic on record changes might require updates to be sent in smaller batches to help prevent time-outs.</span></span>
