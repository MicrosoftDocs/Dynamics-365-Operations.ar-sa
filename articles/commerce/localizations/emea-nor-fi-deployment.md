---
title: إرشادات النشر لآلات تسجيل المدفوعات النقدية الخاصة بالنرويج
description: يقدم هذا المقال دليلا حول كيفيه تمكين وظيفة تسجيل النقد لترجمة Microsoft Dynamics 365 Commerce للنرويج.
author: EvgenyPopovMBS
ms.date: 10/04/2022
ms.topic: article
audience: Application User, Developer, IT Pro
ms.reviewer: v-chgriffin
ms.search.region: Global
ms.author: josaw
ms.search.validFrom: 2019-03-01
ms.openlocfilehash: 0e66ef93e65fecaca23f0434c386507a0672d251
ms.sourcegitcommit: 2bc6680dc6b12d20532d383a0edb84d180885b62
ms.translationtype: HT
ms.contentlocale: ar-SA
ms.lasthandoff: 10/06/2022
ms.locfileid: "9631305"
---
# <a name="deployment-guidelines-for-cash-registers-for-norway"></a>إرشادات النشر لآلات تسجيل المدفوعات النقدية الخاصة بالنرويج

[!include[banner](../includes/banner.md)]

> [!IMPORTANT]
> يجب عليك تنفيذ الخطوات الموضحة في هذه المقالة فقط إذا كنت تستخدم Microsoft Dynamics 365 Commerce الإصدار 10.0.29 أو إصدارا أحدث. في الإصدار التجاري 10.0.28 أو إصدار أقدم ، يجب استخدام الإصدار السابق من مجموعة أدوات تطوير برامج البيع بالتجزئة (SDK) على جهاز ظاهري للمطور (VM) في Microsoft Dynamics Lifecycle Services (LCS). لمزيد من المعلومات، راجع [إرشادات التوزيع للسجلات النقدية للنرويج (قديم)](./emea-nor-loc-deployment-guidelines.md). إذا كنت تستخدم الإصدار التجاري 10.0.28 أو ما قبله وقامت بالترحيل إلى إصدار التجارة 10.0.29 أو إصدارا لاحقا ، فيجب اتباع الخطوات الواردة في [الترحيل من وظيفة التجارة القديمة للنرويج](./emea-nor-fi-migration.md).

توفر هذه المقالة إرشادات حول كيفية تمكين وظيفة تسجيل النقد من أجل الترجمة التجارية للنرويج. تتكون الترجمة من العديد من ملحقات المكونات التي تتيح لك تنفيذ إجراءات مثل طباعة الحقول المخصصة على الإيصالات ، وتسجيل أحداث تدقيق إضافية ، ومعاملات المبيعات ، ومعاملات الدفع في نقاط البيع (POS) ، وتوقيع معاملات المبيعات رقميًا ، وطباعة التقارير بالتنسيقات المحلية . لمزيد من المعلومات حول الترجمة الخاصة بالنرويج، راجع [وظيفة تسجيل النقد للنرويج](./emea-nor-cash-registers.md). لمزيد من المعلومات حول كيفية تكوين Commerce للنرويج، راجع [إعداد Commerce للنرويج](./emea-nor-cash-registers.md#setting-up-commerce-for-norway).

## <a name="set-up-fiscal-registration-for-norway"></a>إعداد عملية التسجيل المالي للنرويج

تعتمد عينة التسجيل المالي للنرويج على [وظيفة التكامل المالي](fiscal-integration-for-retail-channel.md) وهو جزء من Commerce SDK. تقع العينة في مجلد **src\\FiscalIntegration\\SequentialSignatureNorway** في مستودع [حلولDynamics 365 Commerce](https://github.com/microsoft/Dynamics365Commerce.Solutions/). يتكون [النموذج](fiscal-integration-for-retail-channel.md#fiscal-registration-process-and-fiscal-integration-samples-for-fiscal-devices-and-services) من موفر المستند المالي والموصل المالي، وهما امتدادان لCommerce Runtime (CRT). لمزيد من المعلومات حول كيفيه استخدام SDK التجارية ، راجع [تنزيل نماذج sdk والحزم المرجعية الخاصة بالتجارة من GitHub واعداد NuGet](../dev-itpro/retail-sdk/sdk-github.md) تدفقات [بناء لمجموعه SDK](../dev-itpro/build-pipeline.md)المستقلة.

أكمل خطوات اعداد التسجيل المالي كما هو موضح في [اعداد التكامل المالي لقنوات Commerce](./setting-up-fiscal-integration-for-retail-channel.md):

1. [إعداد عملية التسجيل المالي](./setting-up-fiscal-integration-for-retail-channel.md#set-up-a-fiscal-registration-process). تاكد من تدوين الإعدادات الخاصة بعمليه التسجيل المالي [الخاصة بالنرويج](#configure-the-fiscal-registration-process).
1. [تعيين إعدادات معالجة الأخطاء‬](./setting-up-fiscal-integration-for-retail-channel.md#set-error-handling-settings).
1. [تفعيل التنفيذ اليدوي للتسجيل المالي المؤجل](./setting-up-fiscal-integration-for-retail-channel.md#enable-manual-execution-of-deferred-fiscal-registration).
1. [تكوين مكونات القناة](#configure-channel-components).

### <a name="configure-the-fiscal-registration-process"></a>تكوين عمليه التسجيل المالي

اتبع هذه الخطوات لتمكين عملية التسجيل المالي للنرويج في مقر Commerce الرئيسي.

1. تنزيل ملفات التكوين لموفر المستند المالي والموصل المالي من Commerce SDK:

    1. افتح مستودع [حلول Dynamics 365 Commerce](https://github.com/microsoft/Dynamics365Commerce.Solutions/).
    1. يستخدم لفتح فرع الإصدار الذي تم توفيره مؤخرا.
    1. افتح **src \> FiscalIntegration \> SequentialSignatureNorway \> CommerceRuntime**.
    1. قم بتنزيل ملف تكوين موفر المستندات المالية في **DocumentProvider.SequentialSignNorway \> التكوين \> DocumentProviderSequentialSignatureNorwaySample.xml**.
    1. قم بتنزيل ملف تكوين الرابط المالي في **Connector.SequentialSignNorway \> التكوين \> ConnectorSequentialSignatureNorwaySample.xml**.

1. انتقل إلى **Retail وCommerce \> إعداد Headquarters \> المعلمات \> المعلمات المشتركة**. في علامة التبويب السريعة **عام**، عيّن خيار **تمكين التكامل المالي** إلى **نعم**.
1. انتقل إلى **Retail وCommerce \> إعداد القناة \> التكامل المالي \> الموصلات المالية**، وقم بتحميل ملف تكوين موفر المستندات المالية الذي قمت بتنزيله مسبقًا.
1. انتقل إلى **Retail وCommerce \> إعداد القناة \> التكامل المالي \> موفري المستندات المالية**، وقم بتحميل ملف تكوين موفر المستندات المالية الذي قمت بتنزيله مسبقًا.
1. انتقل إلى **Retail وCommerce \> إعداد القناة \> التكامل المالي \> ملفات تعريف الموصل الوظيفية**. قم بإنشاء ملف تعريف وظيفي جديد للموصل، وحدد موفر المستندات والموصل الذي قمت بتحميله مسبقًا.
1. انتقل إلى **Retail وCommerce \> إعداد القناة \> التكامل المالي \> ملفات تعريف الموصل الفنية**. قم بإنشاء ملف تعريف فني جديد للموصل، وحدد الموصل الذي قمت بتحميله مسبقًا. قم بتعيين نوع الموصل إلى **داخلي**.
1. انتقل إلى **Retail وCommerce \> إعداد القناة \> التكامل المالي \> مجموعات الموصلات المالية**، وأنشئ مجموعة موصلات مالية جديدة لملف التعريف الوظيفي للموصل الذي قمت بإنشائه مسبقًا.
1. انتقل إلى **Retail وCommerce \> إعداد القناة \> التكامل المالي \> عمليات التسجيل المالي**. قم بإنشاء عملية تسجيل مالي جديد وخطوة عملية تسجيل مالي، وحدد مجموعة الرابط المالي الذي قمت بإنشائه مسبقًا.
1. انتقل إلى **البيع بالتجزئة والتجارة \> إعداد القناة \> إعداد قناة البيع \> ملفات تعريف نقطة البيع \> ملفات تعريف الوظائف**. حدد ملف تعريف وظائف مرتبط بالمتجر حيث يجب تنشيط عمليه التسجيل. في علامة التبويب السريعة **عملية التسجيل المالي**، حدد عملية التسجيل المالي التي قمت بإنشائها مسبقًا. في علامة التبويب السريعة **الأجهزة المالية**، حدد ملف التعريف الفني للموصل الذي قمت بإنشائه مسبقًا. 
1. انتقل إلى **البيع بالتجزئة والتجارة \> تكنولوجيا معلومات البيع بالتجزئة والتجارة \> جدول التوزيع**. افتح جدول التوزيع، وحدد وظيفتي **1070** and **1090** لنقل البيانات إلى قاعدة بيانات القناة.

### <a name="configure-the-digital-signature-parameters"></a>تكوين معلمات التوقيع الرقمي

يجب تكوين الشهادات التي سيتم استخدامها للتوقيع الرقمي لحركات المبيعات في أحد المتاجر. تستخدم الشهادة الرقمية التي يتم تخزينها في مخزن مفتاح Azure لاجراء التوقيع. بالنسبة لوضع العمل دون اتصال بالوسائط الحديثة، يمكن أيضا اجراء التوقيع باستخدام شهادة رقميه يتم تخزينها في التخزين المحلي للجهاز الذي تم تثبيت نقطه البيع الحديثة عليه.

قبل ان تتمكن من استخدام شهادة رقميه مخزنه في مخزن المخزن الأساسي، يجب إكمال الخطوات التالية.

1. يجب إنشاء مخزن المخزن الأساسي. نوصي بنشر التخزين في نفس المنطقة الجغرافية بمثابة Commerce Scale Unit.
1. يجب تحميل الشهادة إلى تخزين المفتاح المخزن ككلمه سر لسلسله base64.
1. يجب أن يكون تطبيق Application Object Server (AOS) مفوضًا لقراءة الأسرار من مخزن Key Vault.

لمزيد من المعلومات حول كيفيه العمل مع المخزن الرئيسي، راجع [الشروع في العمل مع المخزن الرئيسي لـ Azure](/azure/key-vault/key-vault-get-started).

وبعد ذلك، في صفحة **معلمات المخزن الرئيسي**، يجب تحديد المعلمات للوصول إلى المخزن الرئيسي:

- **الاسم** و **الوصف** – اسم ووصف المخزن الرئيسي.
- **عنوان URL للمخزن الرئيسي** – عنوان URL الخاص بالمخزن الرئيسي.
- **عميل المخزن الرئيسي** – معرف العميل التفاعلي لتطبيق Azure Active Directory (Azure AD) المرتبط بتخزين Key Vault لأغراض المصادقة. يجب أن يكون لهذا العميل حق الوصول لقراءة الأسرار من التخزين.
- **مفتاح سر Key Vault** – مفتاح السر مرتبط بتطبيق Azure AD المستخدم للمصادقة في تخزين Key Vault.
- **الاسم**، و **الوصف**، و **المرجع السري** – الاسم والوصف والمرجع السري للشهادة.

بعد ذلك، يجب عليك تكوين موصل لشهاداتك المخزنة في Key Vault أو تخزين الشهادة المحلي. يتم استخدام هذا الموصل للتوقيع علي جانب القناة.

1. انتقل إلى **Retail وCommerce \> إعداد القناة \> التكامل المالي \> ملفات تعريف الموصل الفنية**.
1. في علامة التبويب السريعة **الإعدادات**، حدد المعلمات التالية للتوقيعات الرقمية:

    - **الاسم السري** – حدد الاسم السري الذي قمت بتكوينه مسبقا في صفحة **معلمات Key Vault**.
    - **بصمه إبهام الشهادة المحلية** – توفر بصمه الإبهام لشهادة مخزنه محليا.
    - **خوارزميه التجزئة** – تحديد واحده من خوارزميات تجزئه التشفير التي يتم دعمها من قبل Microsoft .NET، مثل **SHA1**.
    - **اسم مخزن الشهادات** – هذا الحقل اختياري. يتم استخدام ذلك لتحديد اسم المتجر الافتراضي الذي يجب استخدامه للبحث في الشهادات المحلية.
    - **موقع مخزن الشهادات** – هذا الحقل اختياري. يتم استخدام ذلك لتحديد موقع المتجر الافتراضي الذي يجب استخدامه للبحث في الشهادات المحلية.
    - **جرب الشهادة المحلية أولاً** – حدد هذا الخيار لاستخدام الشهادة من المتجر المحلي افتراضيًا لتوقيع البيانات، بدلاً من الشهادة من Key Vault.
    - **تنشيط فحص السلامة** – لمزيد من المعلومات حول ميزة فحص السلامة، راجع [فحص سلامة التسجيل المالي](./fiscal-integration-for-retail-channel.md#fiscal-registration-health-check).

> [!NOTE]
> - فقط خوارزميه تجزئه التشفير **SHA1** مقبوله حاليا للنرويج.
> - تتم أضافه اسم المتجر وموقع التخزين الافتراضيين لتبسيط عمليه البحث عن الشهادات المحلية في CRT. يتضمن X509StoreProvider قائمه بالمجلدات التي يتم تخزين الشهادات بها. إذا لم يتم تحديد اسم المتجر الافتراضي وموقع المتجر الافتراضي، X509StoreProvider يحاول العثور علي شهادة في جميع المجلدات الموجودة على القائمة الخاصة بها.

### <a name="configure-channel-components"></a>تكوين مكونات القناة

#### <a name="development-environment"></a>بيئة التطوير

اتبع هذه الخطوات لإعداد بيئة تطوير بحيث يمكنك اختبار العينة وتوسيعها.

1. قم بنسخ مستودع [حلول Dynamics 365 Commerce](https://github.com/microsoft/Dynamics365Commerce.Solutions) أو تنزيله. حدد إصدار فرع إصدار صحيح وفقا لإصدار التطبيق أو SDK الخاص بك. لمزيد من المعلومات، راجع [تنزيل نماذج Commerce SDK والحزم المرجعية من GitHub و NuGet](../dev-itpro/retail-sdk/sdk-github.md).
1. افتح حل **SequentialSignatureNorway.sln** ضمن **Dynamics365Commerce.Solutions\\FiscalIntegration\\SequentialSignatureNorway**، وقم بإنشائه.
1. تثبيت ملحقات CRT:

    1. ابحث عن مثبت ملحق CRT:

        - **Commerce Scale Unit:** في مجلد **SequentialSignatureNorway\\ScaleUnit\\ScaleUnit.SequentialSignNorway.Installer\\bin\\Debug\\net461**، ابحث عن مثبت **ScaleUnit.SequentialSignNorway.Installer**.
        - **CRT المحلي في نقطة البيع الحديثة:** في مجلد **SequentialSignatureNorway\\ModernPOS\\ModernPos.SequentialSignNorway.Installer\\bin\\Debug\\net461**، ابحث عن مثبت **ModernPos.SequentialSignNorway.Installer**.

    1. ابدأ مثبت ملحق CRT من سطر الأوامر:

        - **Commerce Scale Unit:**

            ```Console
            ScaleUnit.SequentialSignNorway.Installer.exe install --verbosity 0
            ```

        - **CRT المحلي في نقطة البيع الحديثة:**

            ```Console
            ModernPOS.SequentialSignNorway.Installer.exe install --verbosity 0
            ```

#### <a name="production-environment"></a>بيئة الإنتاج

اتبع الخطوات الواردة في [إعداد تدفق البناء لنموذج تكامل مالي](fiscal-integration-sample-build-pipeline.md) لإنشاء وإصدار وحده مقياس السحابة وحزم الخدمة الذاتية القابلة للنشر لنموذج التكامل المالي. يمكن العثور على ملف YAML لقالب **SequentialSignatureNorway build-pipeline.yaml** في مجلد **Pipeline\\YAML_Files** الخاص بمستودع [حلول Dynamics 365 Commerce](https://github.com/microsoft/Dynamics365Commerce.Solutions).

### <a name="enable-the-digital-signature-in-offline-mode-for-modern-pos"></a>تمكين التوقيع الرقمي في وضع عدم الاتصال لنقاط البيع الحديثة

لتمكين التوقيع الرقمي في وضع عدم الاتصال لـ Modern POS، يجب اتباع هذه الخطوات بعد تنشيط Modern POS على جهاز جديد.

1. سجل الدخول إلى POS.
1. في صفحة **حالة اتصال قاعدة البيانات**، تاكد من مزامنة قاعده البيانات غير المتصلة بشكل كامل. عندما تكون قيمه حقل **التنزيلات المعلقة** هي **0** (صفر)، تتم مزامنة قاعده البيانات بالكامل.
1. قم بتسجيل الخروج من نقطة البيع.
1. انتظر حتى تتم مزامنة قاعدة البيانات دون اتصال بشكل كامل.
1. سجل الدخول إلى POS.
1. في صفحة **حالة اتصال قاعدة البيانات**، تاكد من مزامنة قاعده البيانات غير المتصلة بشكل كامل. عندما تكون قيمه حقل **الحركات المعلقة في قاعدة البيانات غير المتصلة** هي **0** (صفر)، تتم مزامنة قاعده البيانات بالكامل.
1. أعد فتح Modern POS.
