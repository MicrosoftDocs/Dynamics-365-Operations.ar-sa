---
title: تكوين CPOS لاستخدام تطبيق Azure AD مخصص
description: تشرح هذه المقالة كيفية تكوين Cloud POS (CPOS) لاستخدام تطبيق Azure Active Directory (Azure AD) .
author: boycez
ms.date: 11/04/2022
ms.topic: article
audience: Application User, Developer, IT Pro
ms.reviewer: josaw
ms.search.region: global
ms.author: boycez
ms.search.validFrom: 2017-06-20
ms.openlocfilehash: 5e4ff797410e1e94869cc37684e7622ec0d97842
ms.sourcegitcommit: 9e2e54ff7d15aa51e58309da3eb52366328e199d
ms.translationtype: HT
ms.contentlocale: ar-SA
ms.lasthandoff: 11/04/2022
ms.locfileid: "9746250"
---
# <a name="configure-cpos-to-use-a-custom-azure-ad-app"></a>تكوين CPOS لاستخدام تطبيق Azure AD مخصص

[!include [banner](includes/banner.md)]

افتراضيا ، مجموعه نظراء POS (CPOS) بالإشارة Microsoft Dynamics 365 Commerce إلى تطبيق الطرف الأول لشركه Microsoft في Azure Active Directory (Azure AD). التالي ، يمكنك استخدام CPOS دون الحاجة إلى اجراء إيه تغييرات في Azure AD. ومع ذلك ، قد ترغب في الإشارة إلى المثيل الخاص بك من CPOS إلى أحد التطبيقات المخصصة Azure AD التي تتحكم فيها. تشرح هذه المقالة كيفية تكوين CPOS لاستخدام تطبيق مخصص Azure AD .

## <a name="set-up-a-custom-retail-server-app-in-azure-ad"></a>قم بإعداد تطبيق خادم البيع بالتجزئة المخصص في Azure AD

لإنشاء تطبيق خادم البيع بالتجزئة Azure AD المخصص وتكوينه ، اتبع الخطوات التالية.

1. تسجيل الدخول إلى [Azure Active Directory مركز الإدارة](https://aad.portal.azure.com) باستخدام أي Azure AD حساب المستخدم. ليس من الضروري ان يكون لدي حساب المستخدم أذونات المسؤول.
1. تحديد **Azure Active Directory**.
1. حدد **تسجيلات** التطبيق ، ثم حدد **تسجيل** جديد لفتح **مربع الحوار تسجيل** تطبيق
1. قم بتعيين الحقول التالية:

    - **الاسم‏‎** – أدخل اسمًا مخصصًا للتطبيق. علي سبيل المثال ، ادخل **خادم** بيع بالتجزئة مخصص.
    - **أنواع** حسابات الدعم – حدد الخيار الافتراضي ، **الحسابات في هذا الدليل التنظيمي فقط (مستأجر Microsoft فقط-مستأجر واحد)**.
    - **إعادة توجيه URI** – هذا الحقل اختياري. اتركه فارغا.
    - **معرف شجرة الخدمة** – هذا الحقل اختياري. اتركه فارغا.
    
1. حدد **السجل**. تظهر صفحه التكوين للتطبيق المسجل حديثا.
1. في المقطع أساسيات **النظرة \> العامة** ، حدد **أضافه معرف URI** الخاص بمعرف التطبيق ، ثم حدد **تعيين** إلى جانب uri **لمعرف** التطبيق. دون ملاحظه عن القيمة المقترحة ، ثم حدد **حفظ** لقبول هذه القيمة. 
1. حدد **أضف نطاقًا**، ثم قم بتعيين الحقول التالية:

    - **اسم النطاق** - أدخل اسمًا مخصصًا للنطاق. علي سبيل المثال ، قم بإدخال **الإصدار القديم**.
    - **من يمكنه** الاعتماد – حدد ما إذا كان بإمكان المسؤولين والمستخدمين أو المسؤولين فقط منح الموافقة ، استنادا إلى نهج الأمان الخاصة بمؤسسك.
    - **اسم** العرض الخاص بموافقه المسؤول – ادخل اسما للعرض. علي سبيل المثال ، ادخل **خادم** الوصول إلى خادم البيع بالتجزئة.
    - **وصف موافقة المسؤول** – أدخل وصفًا. علي سبيل المثال ، ادخل **منح الوصول إلى واجهات برمجة تطبيقات خادم البيع بالتجزئة**.

1. حدد **أضافه نطاق** لإكمال عمليه إنشاء النطاق.

## <a name="set-up-a-custom-cpos-app-in-azure-ad"></a>قم بإعداد تطبيق CPOS مخصص بتنسيق Azure AD

> [!IMPORTANT]
> إذا كنت تقوم بترقية تطبيق CPOS Azure AD مخصص موجود تم إنشاؤه قبل Commerce الإصدار 10.0.21، فاتبع الخطوات الموجودة في [ترقية تطبيق CPOS Azure AD مخصص موجود تم إنشاؤه قبل Commerce الإصدار 10.0.21](#upgrade-an-existing-custom-cpos-azure-ad-app-created-before-commerce-version-10021).

لإنشاء وتكوين تطبيق CPOS مخصص Azure AD ، اتبع الخطوات التالية.

1. تسجيل الدخول إلى [Azure Active Directory مركز الإدارة](https://aad.portal.azure.com) باستخدام أي Azure AD حساب المستخدم. ليس من الضروري ان يكون لدي حساب المستخدم أذونات المسؤول.
1. تحديد **Azure Active Directory**.
1. حدد **تسجيلات** التطبيق ، ثم حدد **تسجيل** جديد لفتح **مربع الحوار تسجيل** تطبيق
1. قم بتعيين الحقول التالية:

    - **الاسم‏‎** – أدخل اسمًا للتطبيق. علي سبيل المثال ، ادخل **نقطه بيع** مخصصه لسحابه.
    - **أنواع** حسابات الدعم – حدد الخيار الافتراضي ، **الحسابات في هذا الدليل التنظيمي فقط (مستأجر Microsoft فقط-مستأجر واحد)**.
    - لأعاده **URI** التوجيه – حدد **تطبيق الصفحة المفردة (SPA)** في القائمة المنسدلة ، ثم ادخل cpos URI.
    - **معرف شجرة الخدمة** – هذا الحقل اختياري. اتركه فارغا.

1. حدد **السجل**. تظهر صفحه التكوين للتطبيق المسجل حديثا.
1. في مقطع **البيان** ، قم بتعيين **معلمات oauth2AllowIdTokenImplicitFlow** و **oauth2AllowImplicitFlow** علي **القيمة صح** ، ثم حدد **حفظ** .
1. في المقطع تكوين **الرمز** ، اتبع الخطوات التالية لأضافه ادعاءين:

    1. حدد **إضافة مطالبة اختيارية**. قم بتعيين حقل نوع الرمز **إلى** المعرف **، ثم حدد** مطالبه **sid**. حدد **إضافة**.
    1. حدد **إضافة مطالبة اختيارية**. قم بتعيين حقل نوع الرمز **إلى** المدخل **، ثم حدد** مطالبه **sid**. حدد **إضافة**.

1. في جزء **أذونات API** ، حدد **إضافة إذن**.
1. في التبويب واجات APIs التي **يستخدمها** مؤسستي ، ابحث عن تطبيق خادم البيع بالتجزئة الذي قمت بإنشاءه في المقطع اعداد خادم البيع المخصص [للخادم المخصص Azure AD](#set-up-a-custom-retail-server-app-in-azure-ad). ثم حدد **إضافة أذونات**.
1. في المقطع **نظره عامه** ، قم بعمل ملاحظه بالقيمة الموجودة في حقل معرف **(العميل) الخاص بالتطبيق**.

### <a name="upgrade-an-existing-custom-cpos-azure-ad-app-created-before-commerce-version-10021"></a>ترقية تطبيق CPOS Azure AD مخصص موجود تم إنشاؤه قبل Commerce الإصدار 10.0.21

لترقية تطبيق CPOS Azure AD مخصص موجود تم إنشاؤه قبل Commerce الإصدار 10.0.21، اتبع الخطوات التالية. 

1. افتح تطبيق CPOS Azure AD المخصص الموجود في مدخل Azure.
1. حدد علامة التبويب **مصادقة**.
1. انسخ واحفظ عنوان URI الأصلي الخاص بإعادة التوجيه من النوع **ويب** للاستخدام لاحقًا، ثم قم بحذفه.
1. حدد **إضافة نظام أساسي**، ثم حدد **تطبيق الصفحة المفردة (SPA)**.
1. أضف عنوان URI الأصلي الخاص بإعادة التوجيه إلى الويب المنسوخ أعلاه إلى نظام SPA الأساسي.
1. في المقطع تكوين **الرمز** ، اتبع الخطوات التالية لأضافه ادعاءين:
    1. حدد **إضافة مطالبة اختيارية**. قم بتعيين حقل نوع الرمز **إلى** المعرف **، ثم حدد** مطالبه **sid**. حدد **إضافة**.
    1. حدد **إضافة مطالبة اختيارية**. قم بتعيين حقل نوع الرمز **إلى** المدخل **، ثم حدد** مطالبه **sid**. حدد **إضافة**.

## <a name="update-the-cpos-configuration-file"></a>قم بتحديث ملف تكوين CPOS

قم بفتح ملف json الخاص بالتكوين الخاص ب CPOS ، ثم قم بإجراء التحديثات التالية فيه.

1. قم **باستبدال قيمه المفتاح AADClient** بالقيمة الخاصة **بمعرف** التطبيق (العميل) الخاصة بتطبيق cpos المخصص الذي قمت بإنشاءه في المقطع [اعداد "تطبيق cpos" مخصص في Azure AD](#set-up-a-custom-cpos-app-in-azure-ad) قسم
1. استبدل **AADRetailServerResourceId** القيمة الرئيسية مع **معرف التطبيق URI** قيمة تطبيق Retail Server المخصص الذي قمت بإنشائه في [قم بإعداد تطبيق خادم البيع بالتجزئة المخصص في القسم Azure AD](#set-up-a-custom-retail-server-app-in-azure-ad).

ستستخدم CPOS كلتا المعلمتين عند إرسال طلبات إلى Azure AD الحصول علي رمز أمان مميز.

## <a name="update-identity-providers-settings-in-commerce-headquarters"></a>تحديث إعدادات موفري الهوية في Commerce headquarters

بعد ذلك، يجب عليك تحديث إعدادات موفري الهوية في Commerce headquarters.

1. في Commerce headquarters، افتح **صفحة معلمات التجارة المشتركة** .
1. في **علامة التبويب موفرو** الهوية ، في المقطع موفرو **الهوية** ، حدد الصف الذي تم تعيين حقل **النوع** اليه **Azure Active Directory** ويشير الحقل **المصدر** إلى المستأجر الخاص بكAzure AD. يقوم هذا الإعداد بالإعلان عن أنك ستعمل مع الشبكات التابعة التي تحتوي على البيانات المرتبطة بموفر الهوية الذي يتوافق مع مستأجر Azure AD الخاص بك.
1. في الجزء **الاعتماد على الأطراف** ، حدد **أضافه** لأضافه صف.
1. قم بتعيين الحقول التالية:

    - **ClientId** أدخل **معرف التطبيق (العميل)** قيمة تطبيق CPOS المخصص الذي أنشأته في ملف [اعداد "تطبيق cpos" مخصص في Azure AD](#set-up-a-custom-cpos-app-in-azure-ad) قسم.
    - **النوع** – حدد **عام**.
    - **نوع المستخدم** – حدد **العامل**.

1. حدد الصف الذي أضفته. يعرض **قسم معرفات** موارد الخادم أسفل القسم جات **الاعتماد** معرفات تطبيق خادم البيع بالتجزئة التي يمكن الوصول اليها بواسطة التطبيق الذي قمت بتحديده في **شبكه جات** الاعتماد.
1. في المقطع **معرفات** موارد الخادم ، حدد **أضافه** لأضافه صف.
1. في حقل **معرف مورد الخادم** أدخل **معرف التطبيق URI** قيمة تطبيق Retail Server المخصص الذي قمت بإنشائه في [قم بإعداد تطبيق خادم البيع بالتجزئة المخصص في القسم Azure AD](#set-up-a-custom-retail-server-app-in-azure-ad).

    > [!IMPORTANT]
    > تكون كافة الحقول المذكورة في الخطوات السابقة حساسة لحاله الأحرف. يجب ان تتطابق القيم التي تقوم بإدخالها مع القيم التي تم تكوينها في "مركز الإداره Azure AD " تماما.

1. انتقل إلى **تجارة التجزئة وتكنولوجيا المعلومات\> جدول التوزيع** ، وقم بتشغيل **1110** وظيفة (**التكوين العمومي** ).

يمكنك الآن تنشيط أجهزه CPOS باستخدام التطبيق الخاص Azure AD بك.

## <a name="additional-resources"></a>الموارد الإضافية

[تفعيل جهاز نقاط البيع (POS)](dev-itpro/retail-device-activation.md)

[إدارة حسابات التنشيط والتحقق من صحة الأجهزة](set-up-activation-accounts-validate-devices-hq.md)

[!INCLUDE[footer-include](../includes/footer-banner.md)]
